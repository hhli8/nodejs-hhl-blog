webpackJsonp([33],{"6a44":function(e,t){},KNPP:function(e,t){},LzJr:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l("Xxa5"),s=l.n(a),r=l("exGp"),o=l.n(r),i=l("BO1k"),n=l.n(i),u=l("d7EF"),c=l.n(u),d=l("Dd8w"),m=l.n(d),h=l("XpEf"),v={name:"users",components:{},props:{},data:function(){return{loading:!1,selectuserId:"",pageSize:20,totalSize:0,currentPage3:1,usersForm:{userId:null,userPhone:null,userSex:null,userType:null,nickName:null,issueType:null,commentType:null,beShareType:null},forbiddenState:[{value:"1",label:"正常"},{value:"0",label:"封禁"}],formNew:{name:"",region:""},formRole:{region:""},formIssue:{region:"",value:""},optionsGender:[{value:"1",label:"男"},{value:"2",label:"女"}],optionsRole:[],optionsRelease:[{value:"1",label:"正常"},{value:"2",label:"禁止"}],optionsDiscuss:[{value:"1",label:"正常"},{value:"2",label:"禁止"}],optionsShare:[{value:"1",label:"正常"},{value:"2",label:"禁止"}],tableData:[],dialogFormVisibleRole:!1,dialogFormVisibleIssue:!1,dialogFormVisibleComment:!1,dialogFormVisibleShare:!1,dialogFormVisibleNew:!1,formLabelWidth:"120px"}},computed:{},created:function(){this.userRole()},mounted:function(){this.searchUserList()},methods:{userStatusChange:function(e,t,l,a){var s=this;Object(h.P)({userId:e,type:t,userType:l,upToTime:a}).then(function(e){s.searchUserList()})},userRoleChange:function(e,t){var l=this;Object(h.O)({userId:e,type:t}).then(function(e){l.searchUserList()})},userInsert:function(){var e=this,t=this.formNew;Object(h.M)({controlName:t.name,controlType:Boolean(t.region)}).then(function(t){e.userRole()})},userRole:function(){var e=this;Object(h.N)().then(function(t){e.optionsRole=t.dataList})},searchUserList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=arguments[1],a=this.usersForm;"search"===l&&(this.currentPage3=1);var s=m()({derive:Boolean(t),currentPage:this.currentPage3},a);this.loading=!0,Object(h.L)(s,t).then(function(l){if(e.loading=!1,t){var a=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document;charset=utf-8"}),s=document.createElement("a"),r=window.URL.createObjectURL(a);s.href=r,s.download="用户管理列表.xls",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(r)}else e.totalSize=l.totalSize,e.pageSize=l.pageSize,console.log(l.dataList),!l.dataList||l.dataList.length<=0?e.tableData=[]:e.releaseStatus(l.dataList)}).catch(function(t){e.loading=!1,e.$message.error(t)})},queryVerification:function(){var e=this.usersForm,t=null,l=!0;return e.userSex?e.userType?e.issueType?e.commentType?e.beShareType?l=!1:t="请选择被分享状态":t="请选择评论状态":t="请选择发布状态":t="请选择用户角色":t="请选择性别",l&&this.$message.error(t),l},releaseStatus:function(e){var t=void 0,l=void 0,a=void 0,s=!0,r=!1,o=void 0;try{for(var i,u=n()(e.entries());!(s=(i=u.next()).done);s=!0){var d=i.value,h=c()(d,2),v=h[0],b=h[1];b.userSex="1"===b.userSex?"男":"女",t={releaseStatus:b.issue&&Date.parse(new Date(b.issue)),discussStatus:b.comment&&Date.parse(new Date(b.comment)),shareStatus:b.beShare&&Date.parse(new Date(b.beShare))},l=this.getSeconds(t),a=this.timeFilter(t),e[v]=m()({},b,l,a,{orderNum:v+1})}}catch(e){r=!0,o=e}finally{try{!s&&u.return&&u.return()}finally{if(r)throw o}}console.log(e),this.tableData=e},getSeconds:function(e){var t=m()({},e),l=new Date,a=void 0,s=void 0,r=void 0;for(var o in t)t[o]?(s=Math.round((t[o]-l)/1e3),a=(r=parseInt(s))>2592e3?"封禁"+parseInt(r/2592e3)+"月":r>86400?"封禁"+parseInt(r/86400)+"天":r>3600?"封禁"+parseInt(r/3600)+"小时":r>60?"封禁"+parseInt(r/60)+"分钟":r<60&&r>0?"封禁"+r+"秒":"正常",t[o]=a):t[o]="";return t},timeFilter:function(e){var t={issue:e.releaseStatus,comment:e.discussStatus,beShare:e.shareStatus},l=void 0,a=void 0,s=void 0,r=void 0,o=void 0,i=void 0,n=void 0;for(var u in t)t[u]?(l=(n=new Date(t[u]-0)).getFullYear(),a=n.getMonth()+1,s=n.getDate(),r=n.getHours(),o=n.getMinutes(),i=n.getSeconds(),a=a<10?"0"+a:a,s=s<10?"0"+s:s,r=r<10?"0"+r:r,o=o<10?"0"+o:o,i=i<10?"0"+i:i,t[u]=l+"-"+a+"-"+s+" "+r+":"+o+":"+i):t[u]="";return t},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.searchUserList()},handleSure:function(e){var t=void 0,l=void 0;switch(e){case 1:var a=this.formRole.region;a?(this.userRoleChange(this.selectuserId,a),this.dialogFormVisibleRole=!1):this.$message.error("请选择用户角色");break;case 2:(t=this.formIssue).region?t.value?(l=t.value.getTime(),this.userStatusChange(this.selectuserId,1,t.region,l),this.dialogFormVisibleIssue=!1):this.$message.error("请选择封禁截至时间"):this.$message.error("请选择发布状态");break;case 3:(t=this.formIssue).region?t.value?(l=t.value.getTime(),this.userStatusChange(this.selectuserId,2,t.region,l),this.dialogFormVisibleComment=!1):this.$message.error("请选择封禁截至时间"):this.$message.error("请选择评论状态");break;case 4:(t=this.formIssue).region?t.value?(l=t.value.getTime(),this.userStatusChange(this.selectuserId,3,t.region,l),this.dialogFormVisibleShare=!1):this.$message.error("请选择封禁截至时间"):this.$message.error("请选择被分享状态");break;case 5:var s=this.formNew;s.name?s.region?(this.dialogFormVisibleNew=!1,this.userInsert()):this.$message.error("请选择权限"):this.$message.error("请输入用户角色")}},handleEdit:function(e,t,l){var a={region:"",value:""};switch(l){case 1:if(this.formRole.region="",t.userAuthority){var s=this.optionsRole.filter(function(e){if(e.author===t.userAuthority)return e});this.formRole.region=s[0].id}this.dialogFormVisibleRole=!0,this.selectuserId=t.userId;break;case 2:var r=t.releaseStatus;a.region=r&&("正常"===r?"1":"0"),a.value=t.issue&&new Date(Date.parse(t.issue)),this.formIssue=a,this.dialogFormVisibleIssue=!0,this.selectuserId=t.userId;break;case 3:var o=t.discussStatus;a.region=o&&("正常"===o?"1":"0"),a.value=t.comment&&new Date(Date.parse(t.comment)),this.formIssue=a,this.dialogFormVisibleComment=!0,this.selectuserId=t.userId;break;case 4:var i=t.shareStatus;a.region=i&&("正常"===i?"1":"0"),a.value=t.beShare&&new Date(Date.parse(t.beShare)),this.formIssue=a,this.dialogFormVisibleShare=!0,this.selectuserId=t.userId;break;case 5:this.dialogFormVisibleNew=!0;break;case 6:this.open()}},open:function(){var e=this;this.$confirm("确定要导出数据?","导出数据",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:0===e.tableData.length?e.$message.warning("暂无数据，导出失败"):e.totalSize-0>5e4?e.$message.warning("导出数据大于5万条，请筛选后在导出！"):e.searchUserList(1);case 1:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message.info("已取消操作")})}}},b={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"faceworld-video"},[l("el-container",[l("el-header",[l("div",{staticClass:"hotsearch-nav"},[l("h3",[e._v("用户管理")]),e._v(" "),l("ul",{staticClass:"hotsearch-nav-right"},[l("li",{on:{click:function(t){e.handleEdit(null,null,5)}}},[e._v("+新建用户角色")])])])]),e._v(" "),l("el-main",[l("div",{staticClass:"users-header"},[l("el-row",{attrs:{gutter:10}},[l("el-col",{attrs:{span:3}},[l("el-input",{attrs:{placeholder:"用户id",clearable:""},model:{value:e.usersForm.userId,callback:function(t){e.$set(e.usersForm,"userId",t)},expression:"usersForm.userId"}})],1),e._v(" "),l("el-col",{attrs:{span:3}},[l("el-input",{attrs:{placeholder:"手机号",clearable:""},model:{value:e.usersForm.userPhone,callback:function(t){e.$set(e.usersForm,"userPhone",t)},expression:"usersForm.userPhone"}})],1),e._v(" "),l("el-col",{attrs:{span:3}},[l("el-select",{attrs:{placeholder:"性别",clearable:""},model:{value:e.usersForm.userSex,callback:function(t){e.$set(e.usersForm,"userSex",t)},expression:"usersForm.userSex"}},e._l(e.optionsGender,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),l("el-col",{attrs:{span:3}},[l("el-input",{attrs:{placeholder:"用户昵称",clearable:""},model:{value:e.usersForm.nickName,callback:function(t){e.$set(e.usersForm,"nickName",t)},expression:"usersForm.nickName"}})],1),e._v(" "),l("el-col",{attrs:{span:3}},[l("el-select",{attrs:{placeholder:"用户角色",clearable:""},model:{value:e.usersForm.userType,callback:function(t){e.$set(e.usersForm,"userType",t)},expression:"usersForm.userType"}},e._l(e.optionsRole,function(e){return l("el-option",{key:e.id,attrs:{label:e.author,value:e.id}})}))],1),e._v(" "),l("el-col",{attrs:{span:3}},[l("el-select",{attrs:{placeholder:"发布状态",clearable:""},model:{value:e.usersForm.issueType,callback:function(t){e.$set(e.usersForm,"issueType",t)},expression:"usersForm.issueType"}},e._l(e.optionsRelease,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),l("el-col",{attrs:{span:3}},[l("el-select",{attrs:{placeholder:"评论状态",clearable:""},model:{value:e.usersForm.commentType,callback:function(t){e.$set(e.usersForm,"commentType",t)},expression:"usersForm.commentType"}},e._l(e.optionsDiscuss,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),l("el-col",{attrs:{span:3}},[l("el-select",{attrs:{placeholder:"被分享转态",clearable:""},model:{value:e.usersForm.beShareType,callback:function(t){e.$set(e.usersForm,"beShareType",t)},expression:"usersForm.beShareType"}},e._l(e.optionsShare,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),l("el-row",{staticClass:"mt-10",attrs:{gutter:10}},[l("el-col",{attrs:{span:2}},[l("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchUserList(0,"search")}}},[e._v("查询")])],1),e._v(" "),l("el-col",{attrs:{span:2}},[l("el-button",{attrs:{plain:"",icon:"el-icon-upload2"},on:{click:function(t){e.handleEdit(null,null,6)}}},[e._v("导出")])],1)],1)],1),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""}},[l("el-table-column",{attrs:{prop:"orderNum",label:"序号",align:"center",width:"50"}}),e._v(" "),l("el-table-column",{attrs:{prop:"userId",label:"用户userId",align:"center",width:"120"}}),e._v(" "),l("el-table-column",{attrs:{prop:"userPhone",label:"手机号",align:"center",width:"120"}}),e._v(" "),l("el-table-column",{attrs:{prop:"userSex",label:"性别",align:"center",width:"60"}}),e._v(" "),l("el-table-column",{attrs:{prop:"nickName",label:"昵称",align:"center",width:"80"}}),e._v(" "),l("el-table-column",{attrs:{prop:"userAuthority",label:"用户角色",align:"center",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"releaseStatus",label:"发布状态",align:"center",width:"80"}}),e._v(" "),l("el-table-column",{attrs:{prop:"issue",label:"发布封禁截止时间",align:"center",width:"160"}}),e._v(" "),l("el-table-column",{attrs:{prop:"discussStatus",label:"评论状态",align:"center",width:"80"}}),e._v(" "),l("el-table-column",{attrs:{prop:"comment",label:"评论封禁截止时间",align:"center",width:"160"}}),e._v(" "),l("el-table-column",{attrs:{prop:"shareStatus",label:"被分享状态",align:"center",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"beShare",label:"被分享封禁截止时间",align:"center",width:"160"}}),e._v(" "),l("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"450",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{size:"mini"},on:{click:function(l){e.handleEdit(t.$index,t.row,1)}}},[e._v("角色变更")]),e._v(" "),l("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(l){e.handleEdit(t.$index,t.row,2)}}},[e._v("发布变更")]),e._v(" "),l("el-button",{attrs:{size:"mini"},on:{click:function(l){e.handleEdit(t.$index,t.row,3)}}},[e._v("评论变更")]),e._v(" "),l("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(l){e.handleEdit(t.$index,t.row,4)}}},[e._v("被分享变更")])]}}])})],1)],1),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:e.totalSize>0,expression:"totalSize>0"}],staticClass:"pagination-container"},[l("el-pagination",{attrs:{background:"","current-page":e.currentPage3,"page-size":e.pageSize,layout:"prev, pager, next, jumper",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage3=t}}})],1)],1),e._v(" "),l("div",{staticClass:"userPopup"},[l("el-dialog",{attrs:{title:"角色变更",visible:e.dialogFormVisibleRole},on:{"update:visible":function(t){e.dialogFormVisibleRole=t}}},[l("el-form",{attrs:{model:e.formRole}},[l("el-form-item",{attrs:{label:"用户角色","label-width":e.formLabelWidth}},[l("el-select",{attrs:{placeholder:"请选择用户角色",clearable:""},model:{value:e.formRole.region,callback:function(t){e.$set(e.formRole,"region",t)},expression:"formRole.region"}},e._l(e.optionsRole,function(e){return l("el-option",{key:e.id,attrs:{label:e.author,value:e.id}})}))],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisibleRole=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSure(1)}}},[e._v("确 定")])],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"发布变更",visible:e.dialogFormVisibleIssue},on:{"update:visible":function(t){e.dialogFormVisibleIssue=t}}},[l("el-form",{attrs:{model:e.formIssue}},[l("el-form-item",{attrs:{label:"发布状态","label-width":e.formLabelWidth}},[l("el-select",{attrs:{placeholder:"请选择发布状态",clearable:""},model:{value:e.formIssue.region,callback:function(t){e.$set(e.formIssue,"region",t)},expression:"formIssue.region"}},[l("el-option",{attrs:{label:"正常",value:"1"}}),e._v(" "),l("el-option",{attrs:{label:"封禁",value:"0"}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"封禁截止时间","label-width":e.formLabelWidth}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.formIssue.value,callback:function(t){e.$set(e.formIssue,"value",t)},expression:"formIssue.value"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisibleIssue=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSure(2)}}},[e._v("确 定")])],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"评论变更",visible:e.dialogFormVisibleComment},on:{"update:visible":function(t){e.dialogFormVisibleComment=t}}},[l("el-form",{attrs:{model:e.formIssue}},[l("el-form-item",{attrs:{label:"评论状态","label-width":e.formLabelWidth}},[l("el-select",{attrs:{placeholder:"请选择评论状态",clearable:""},model:{value:e.formIssue.region,callback:function(t){e.$set(e.formIssue,"region",t)},expression:"formIssue.region"}},[l("el-option",{attrs:{label:"正常",value:"1"}}),e._v(" "),l("el-option",{attrs:{label:"封禁",value:"0"}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"封禁截止时间","label-width":e.formLabelWidth}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.formIssue.value,callback:function(t){e.$set(e.formIssue,"value",t)},expression:"formIssue.value"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisibleComment=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSure(3)}}},[e._v("确 定")])],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"被分享变更",visible:e.dialogFormVisibleShare},on:{"update:visible":function(t){e.dialogFormVisibleShare=t}}},[l("el-form",{attrs:{model:e.formIssue}},[l("el-form-item",{attrs:{label:"被分享状态","label-width":e.formLabelWidth}},[l("el-select",{attrs:{placeholder:"请选择被分享状态",clearable:""},model:{value:e.formIssue.region,callback:function(t){e.$set(e.formIssue,"region",t)},expression:"formIssue.region"}},[l("el-option",{attrs:{label:"正常",value:"1"}}),e._v(" "),l("el-option",{attrs:{label:"封禁",value:"0"}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"封禁时间(月)","label-width":e.formLabelWidth}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.formIssue.value,callback:function(t){e.$set(e.formIssue,"value",t)},expression:"formIssue.value"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisibleShare=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSure(4)}}},[e._v("确 定")])],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"新建用户角色",visible:e.dialogFormVisibleNew},on:{"update:visible":function(t){e.dialogFormVisibleNew=t}}},[l("el-form",{attrs:{model:e.formNew}},[l("el-form-item",{attrs:{label:"用户角色","label-width":e.formLabelWidth}},[l("el-input",{attrs:{autocomplete:"off",placeholder:"请选择用户角色"},model:{value:e.formNew.name,callback:function(t){e.$set(e.formNew,"name",t)},expression:"formNew.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"权限","label-width":e.formLabelWidth}},[l("el-select",{attrs:{placeholder:"请选择权限",clearable:""},model:{value:e.formNew.region,callback:function(t){e.$set(e.formNew,"region",t)},expression:"formNew.region"}},[l("el-option",{attrs:{label:"先发后审",value:"1"}}),e._v(" "),l("el-option",{attrs:{label:"先审后发",value:"2"}})],1)],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisibleNew=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSure(5)}}},[e._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]};var p=l("VU/8")(v,b,!1,function(e){l("KNPP"),l("6a44")},"data-v-c286168e",null);t.default=p.exports}});