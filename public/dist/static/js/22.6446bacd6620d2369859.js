webpackJsonp([22],{"162o":function(e,t,o){(function(e){var a=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function l(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new l(i.call(setTimeout,a,arguments),clearTimeout)},t.setInterval=function(){return new l(i.call(setInterval,a,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(a,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},o("mypn"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(t,o("DuR2"))},"APR/":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("rqx2"),i=o("voil"),l=o("162o"),r={components:{Loading:i.a},data:function(){return{dialogEditOrder:!1,loadingQueryGoods:!1,activityTitle:"",showLoading:!1,multipleQueryGoodsTable:[],formInline:{},tableData3:[],multipleTable:[],brands:[],showAddGoodsDialog:!1,dialogDeleteVisible:!1,pageNum:1,pageSize:10,total:1,totalPage:0,currentPage:1,pageSizeDetail:10,pageNumDetail:1,totalDetail:1,totalPageDetail:0,currentPageDetail:1,detailParam:{pageNum:1,pageSize:10},queryGoodsListparam:{categoryName:"",discountPriceLower:"",discountPriceUpper:"",couponStartTime:"",couponEndTime:"",asc:1,goodsName:"",itemId:"",pageNum:1,pageSize:10},addGoodsList:[],tableData:[],dialogFormVisible:!1,formLabelWidth:"120px",pickerOptions1:{},editOrderform:{goodsConfigId:"",orderNum:""}}},created:function(){var e=JSON.parse(this.$route.query.activityId);this.activityId=e,this.activityTitle=this.$route.query.activityTitle,this.getCategory(),this.getDetail(e)},methods:{getCategory:function(){var e=this;a.a.getCategoryList({level:3}).then(function(t){e.brands=t.dataList}).catch()},getDetail:function(e){var t=this;t.detailParam.activityId=t.activityId,a.a.getActivityGoodsList(t.detailParam).then(function(e){t.showLoading=!1,t.tableData3=e.dataList,t.totalPageDetail=e.totalSize,t.currentPageDetail=e.currentPage,t.pageSizeDetail=e.pageSize,t.totalDetail=e.totalSize}).catch(function(){t.showLoading=!1})},addGoods:function(){this.showAddGoodsDialog=!0},query:function(){this.queryGoodsListparam.pageNum=1,this.loadingQueryGoods=!0,this.queryGoodsListparam.couponStartTime||(this.queryGoodsListparam.couponStartTime=""),this.queryGoodsListparam.couponEndTime||(this.queryGoodsListparam.couponEndTime=""),this.queryList(this.queryGoodsListparam)},queryList:function(e){var t=this;a.a.queryGoodsList(t.queryGoodsListparam).then(function(e){t.addGoodsList=e.dataList,t.totalPage=e.totalSize,t.currentPage=e.currentPage,t.pageSize=e.pageSize,t.total=e.totalSize,t.loadingQueryGoods=!1}).catch(function(){t.loadingQueryGoods=!1})},saveGoods:function(){var e=this,t={activityId:e.activityId,specialGoodsDTOS:e.multipleQueryGoodsTable};a.a.saveGoodsList(t).then(function(t){200===t.code&&(e.showAddGoodsDialog=!1,e.getDetail())}).catch()},cancelSaveGoods:function(){this.addGoodsList=[],this.showAddGoodsDialog=!1},deleteline:function(){var e=this;console.log(111111);for(var t={activityId:e.activityId,goodsConfigIds:"",shelves:-1},o=[],i=0;i<e.multipleTable.length;i++)o.push(e.multipleTable[i].goodsConfigId);t.goodsConfigIds=o.join(","),a.a.updateGoods(t).then(function(t){200===t.code&&(e.dialogDeleteVisible=!1,e.getDetail())}).catch()},deleteGoods:function(){console.log(this.multipleTable),this.dialogDeleteVisible=!0},cancelAddGoodsDialog:function(){this.showAddGoodsDialog=!1},saveActivityGoods:function(){var e=this,t={activityId:e.activityId};a.a.refreshGoods(t).then(function(t){200===t.code&&(e.$message({message:"活动发布成功",type:"success"}),Object(l.setTimeout)(function(){e.$router.push("promotionActivity")},300))}).catch()},saveActivity:function(){},cancelActivity:function(){},handleSelectionChange:function(e){this.multipleTable=e},handleSelectionChangeGoods:function(e){this.multipleQueryGoodsTable=e},handleSizeChange:function(e){this.pageSize=e,this.queryGoodsListparam.pageSize=e,this.queryList()},handleCurrentChange:function(e){this.currentPageDe=e,this.queryGoodsListparam.pageNum=e,this.queryList()},handleSizeChangeDetail:function(e){this.pageSizeDetail=e,this.detailParam.pageSize=e,this.getDetail()},handleCurrentChangeDetail:function(e){this.currentPageDetail=e,this.detailParam.pageNum=e,this.getDetail()},editOrder:function(e){this.editOrderform.goodsConfigId=e.row.goodsConfigId,this.editOrderform.orderNum=e.row.orderNum,this.dialogEditOrder=!0,console.log(this.editOrderform)},saveOrder:function(){var e=this;a.a.updateOrder(e.editOrderform).then(function(t){e.getDetail(),e.dialogEditOrder=!1}).catch()},muti:function(e){return e.length>0?"el-button el-button--primary":"noClick"},sortChange:function(e){console.log(e),this.queryGoodsListparam.sortFiled=e.prop,"descending"===e.order?this.queryGoodsListparam.asc=0:this.queryGoodsListparam.asc=1,this.query()}}},s={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-row",[o("h2",{staticClass:"title"},[e._v(e._s(e.activityTitle))])]),e._v(" "),o("el-row",[o("h4",[e._v("商品配置")])]),e._v(" "),o("hr"),e._v(" "),o("section",[o("el-row",{staticStyle:{margin:"10px 0"}},[o("el-button",{attrs:{type:"primary"},on:{click:e.addGoods}},[e._v("添加商品")]),e._v(" "),o("el-button",{class:e.muti(e.multipleTable),attrs:{type:"danger",icon:"el-icon-delete",disabled:0==e.multipleTable.length},on:{click:e.deleteGoods}},[e._v("删除商品")]),e._v(" "),o("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.saveActivityGoods}},[e._v("发布活动商品")])],1)],1),e._v(" "),o("section",[o("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData3,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),o("el-table-column",{attrs:{prop:"itemId",label:"商品ID",align:"center",width:"150"}}),e._v(" "),o("el-table-column",{attrs:{prop:"title",align:"center",label:"商品名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"picUrl",label:"商品图片",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(e){return[o("img",{staticStyle:{height:"60px"},attrs:{src:e.row.picUrl,alt:""}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"categoryName",label:"商品分类","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"price",label:"商品原价(元)",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.price/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"discountPrice",label:"券后价(元)",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.discountPrice/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"couponPrice",label:"优惠券(元)",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.couponPrice/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"address",label:"商品顺序",align:"center",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.orderNum))]),o("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(o){e.editOrder(t)}}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"status",label:"优惠券有效期",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v("开始"+e._s(t.row.couponStartTime))]),o("br"),o("span",[e._v("结束"+e._s(t.row.couponEndTime))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"status",label:"商品状态",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s(1===t.row.status?"上架":"下架"))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"xxypVolume",label:"商品已售（小象平台/总售出）",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[o("span",[e._v(e._s(t.row.xxypVolume))]),o("span",[e._v("/")]),o("span",[e._v(e._s(t.row.salesVolume))])])]}}])})],1),e._v(" "),o("div",{staticClass:"pagination-container"},[o("el-pagination",{attrs:{background:"","current-page":e.currentPageDetail,"page-sizes":[10,20,30,40],"page-size":e.pageSizeDetail,layout:"total, sizes, prev, pager, next",total:e.totalDetail},on:{"size-change":e.handleSizeChangeDetail,"current-change":e.handleCurrentChangeDetail}})],1)],1),e._v(" "),o("hr"),e._v(" "),o("el-dialog",{attrs:{title:"添加商品",width:"92%",visible:e.showAddGoodsDialog,"close-on-click-modal":!1,"before-close":e.cancelAddGoodsDialog},on:{"update:visible":function(t){e.showAddGoodsDialog=t}}},[o("section",[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.queryGoodsListparam}},[o("el-form-item",[o("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择商品分类"},model:{value:e.queryGoodsListparam.categoryName,callback:function(t){e.$set(e.queryGoodsListparam,"categoryName",t)},expression:"queryGoodsListparam.categoryName"}},e._l(e.brands,function(e){return o("el-option",{key:e.id,attrs:{label:e.categoryName,value:e.categoryName}})}))],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{clearable:"",placeholder:"请输入商品名称"},model:{value:e.queryGoodsListparam.goodsName,callback:function(t){e.$set(e.queryGoodsListparam,"goodsName",t)},expression:"queryGoodsListparam.goodsName"}})],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{clearable:"",placeholder:"请输入商品编号"},model:{value:e.queryGoodsListparam.itemId,callback:function(t){e.$set(e.queryGoodsListparam,"itemId",t)},expression:"queryGoodsListparam.itemId"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"商品原价"}},[o("el-col",{attrs:{span:11}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.priceLower,callback:function(t){e.$set(e.queryGoodsListparam,"priceLower",t)},expression:"queryGoodsListparam.priceLower"}})],1),e._v(" "),o("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),o("el-col",{attrs:{span:11}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.priceUpper,callback:function(t){e.$set(e.queryGoodsListparam,"priceUpper",t)},expression:"queryGoodsListparam.priceUpper"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"券后价格区间"}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.discountPriceLower,callback:function(t){e.$set(e.queryGoodsListparam,"discountPriceLower",t)},expression:"queryGoodsListparam.discountPriceLower"}})],1),e._v(" "),o("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.discountPriceUpper,callback:function(t){e.$set(e.queryGoodsListparam,"discountPriceUpper",t)},expression:"queryGoodsListparam.discountPriceUpper"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"优惠券金额"}},[o("el-col",{attrs:{span:11}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.couponPriceLower,callback:function(t){e.$set(e.queryGoodsListparam,"couponPriceLower",t)},expression:"queryGoodsListparam.couponPriceLower"}})],1),e._v(" "),o("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),o("el-col",{attrs:{span:11}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.couponPriceUpper,callback:function(t){e.$set(e.queryGoodsListparam,"couponPriceUpper",t)},expression:"queryGoodsListparam.couponPriceUpper"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"优惠券有效期"}},[o("el-col",{attrs:{span:11}},[o("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"年/月/日"},model:{value:e.queryGoodsListparam.couponStartTime,callback:function(t){e.$set(e.queryGoodsListparam,"couponStartTime",t)},expression:"queryGoodsListparam.couponStartTime"}})],1),e._v(" "),o("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),o("el-col",{attrs:{span:11}},[o("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"年/月/日"},model:{value:e.queryGoodsListparam.couponEndTime,callback:function(t){e.$set(e.queryGoodsListparam,"couponEndTime",t)},expression:"queryGoodsListparam.couponEndTime"}})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")])],1)],1)],1),e._v(" "),o("section",[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingQueryGoods,expression:"loadingQueryGoods"}],ref:"multipleQueryGoodsTable",staticStyle:{width:"100%"},attrs:{data:e.addGoodsList,border:""},on:{"selection-change":e.handleSelectionChangeGoods,"sort-change":e.sortChange}},[o("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"itemId",align:"center",label:"商品编号"}}),e._v(" "),o("el-table-column",{attrs:{prop:"title",align:"center",width:"100",label:"商品名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"picUrl",align:"center",label:"商品图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[o("img",{staticStyle:{height:"60px"},attrs:{src:e.row.picUrl,alt:""}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"categoryName",align:"center",label:"商品分类"}}),e._v(" "),o("el-table-column",{attrs:{prop:"price",align:"center",width:"150",sortable:"price",label:"商品原价(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.price/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"discountPrice",align:"center",sortable:"discountPrice",label:"券后价(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.discountPrice/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"couponPrice",align:"center",sortable:"couponPrice",label:"优惠券(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.couponPrice/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"status",label:"优惠券有效期","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v("开始"+e._s(t.row.couponStartTime))]),o("br"),o("span",[e._v("结束"+e._s(t.row.couponEndTime))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"salesVolume",align:"center",sortable:"salesVolume",label:"商品已售（小象平台/总售出）"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[o("span",[e._v(e._s(t.row.xxypVolume||0))]),e._v("/"),o("span",[e._v(e._s(t.row.salesVolume))])])]}}])})],1),e._v(" "),o("div",{staticClass:"block"},[o("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),o("hr"),e._v(" "),o("el-row",[o("el-button",{on:{click:e.cancelSaveGoods}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.saveGoods}},[e._v("确定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.dialogDeleteVisible,width:"30%"},on:{"update:visible":function(t){e.dialogDeleteVisible=t}}},[o("span",[e._v("您确认删除选中的商品吗？")]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogDeleteVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.deleteline}},[e._v("确 定")])],1)]),e._v(" "),o("el-dialog",{attrs:{title:"修改排序：",width:"40%",visible:e.dialogEditOrder},on:{"update:visible":function(t){e.dialogEditOrder=t}}},[o("el-form",{attrs:{model:e.editOrderform}},[o("el-form-item",{attrs:{label:"排序值:","label-width":e.formLabelWidth}},[o("el-input",{attrs:{type:"number",placeholder:"请输入数字",autocomplete:"off"},model:{value:e.editOrderform.orderNum,callback:function(t){e.$set(e.editOrderform,"orderNum",t)},expression:"editOrderform.orderNum"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogEditOrder=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.saveOrder}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var n=o("VU/8")(r,s,!1,function(e){o("esgb")},"data-v-4a03d3ee",null);t.default=n.exports},esgb:function(e,t){},mypn:function(e,t,o){(function(e,t){!function(e,o){"use strict";if(!e.setImmediate){var a,i,l,r,s,n=1,c={},d=!1,u=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?a=function(e){t.nextTick(function(){f(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,o=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=o,t}}()?e.MessageChannel?((l=new MessageChannel).port1.onmessage=function(e){f(e.data)},a=function(e){l.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(i=u.documentElement,a=function(e){var t=u.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):a=function(e){setTimeout(f,0,e)}:(r="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&f(+t.data.slice(r.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),a=function(t){e.postMessage(r+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),o=0;o<t.length;o++)t[o]=arguments[o+1];var i={callback:e,args:t};return c[n]=i,a(n),n++},p.clearImmediate=m}function m(e){delete c[e]}function f(e){if(d)setTimeout(f,0,e);else{var t=c[e];if(t){d=!0;try{!function(e){var t=e.callback,a=e.args;switch(a.length){case 0:t();break;case 1:t(a[0]);break;case 2:t(a[0],a[1]);break;case 3:t(a[0],a[1],a[2]);break;default:t.apply(o,a)}}(t)}finally{m(e),d=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,o("DuR2"),o("W2nU"))}});