webpackJsonp([76],{sZBp:function(e,t){},wJ8x:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),n=a.n(o),s=a("oedn"),i=a("TIfe"),r={name:"bursting",data:function(){return{loading:!1,flag:!1,showAddDialog:!1,showDialog:!1,dataList:[],goodsDataList:[],brands1:[],brands2:[],brands3:[],uploadUrl:"https://www.xiaoxiangyoupin.com/xxyp-manager/upload/uploadPic",form:{imgType:1,imgTagStatus:1,imgTag:"",imgTagText:"",standTagStatus:"",standTag:"",standTagText:""},currentPage:1,currentPageGood:1,pageNum:1,pageSize:20,pageSizeGood:20,totalSize:0,totalSizeGood:0,checkParam:{bannerId:"",categoryOne:"",categoryTwo:"",categoryThree:"",title:"",status:"",pageNum:1,pageSize:20},statusArr:[{label:"全部",value:""},{label:"已选入",value:1}],curRowIndex:0}},created:function(){this.getList(),this.getBrands(0,1)},computed:{uploadHeader:function(){return{Token:Object(i.c)()}}},methods:{getBrands:function(e,t){var a=this,o={parentId:e};s.a.getCategoryList(o).then(function(e){a.brands1=e.data,a.getBrands2(a.brands1[0].name,2)}).catch()},getBrands2:function(e,t){var a=this,o={};a.brands1.forEach(function(t,a){t.name!==e||(o.parentId=t.id)}),s.a.getCategoryList(o).then(function(e){a.brands2=e.data,a.brands3=[]}).catch()},getBrands3:function(e,t){var a=this,o={};a.brands2.forEach(function(t,a){t.name!==e||(o.parentId=t.id)}),s.a.getCategoryList(o).then(function(e){a.brands3=e.data}).catch()},getList:function(){var e=this;s.a.getSpecialList({type:1,showType:0,pageNum:1,pageSize:20}).then(function(t){e.dataList=t.dataList,e.totalSize=t.totalSize}).catch()},getGoodsList:function(){var e=this;e.loading=!0,s.a.getGoodsCate(e.checkParam).then(function(t){e.loading=!1,e.goodsDataList=t.dataList,e.totalSizeGood=t.totalSize}).catch()},add:function(){this.dataList.push({imgUrl:""})},selectBtn:function(e){this.checkParam.bannerId=e.id,this.bannerId=e.id,this.showAddDialog=!0},editLine:function(e){console.log(this.flag),this.flag?this.showDialog=!0:(this.flag=!0,this.form.imgType=e.imgType,this.form.imgTagStatus=e.imgTagStatus,this.form.imgTag=e.imgTag,this.form.imgTagText=e.imgTagText,this.form.standTagStatus=e.standTagStatus,this.form.standTag=e.standTag,this.form.standTagText=e.standTagText,this.showDialog=!0)},updateLine:function(e){var t=this;e.imgType=t.form.imgType,e.imgTagStatus=t.form.imgTagStatus,e.imgTag=t.form.imgTag,e.imgTagText=t.form.imgTagText,e.standTagStatus=t.form.standTagStatus,e.standTag=t.form.standTag,e.standTagText=t.form.standTagText,e.bannerType=0,e.type=1,s.a.saveSpecial(e).then(function(e){200===e.code?(t.$message({type:"success",message:e.message}),t.flag=!1,t.form={imgType:1,imgTagStatus:1,imgTag:"",imgTagText:"",standTagStatus:"",standTag:"",standTagText:""},t.getList()):t.$message({type:"error",message:e.message})}).catch()},deleteLine:function(e,t){var a=this;e.id?a.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={bannerId:e.id};s.a.deleteSpecial(t).then(function(e){e&&(a.$message({type:"success",message:e.message}),a.getList())}).catch()}):a.dataList.splice(t,1)},selectLine:function(e){var t=this,a=1===e.status?-1:1,o={bannerId:t.bannerId,targetCode:e.targetCode,status:a};s.a.selectToggle(o).then(function(e){t.$message({type:"success",message:e.message}),t.getGoodsList()}).catch()},cancelAdd:function(){this.flag=!1,this.showDialog=!1},cancelAddGood:function(){this.flag=!1,this.showAddDialog=!1},onSubmit:function(){this.showDialog=!1,this.flag=!0,console.log(n()(this.dataList))},handleAvatarSuccess:function(e){this.$message({type:"success",message:"上传成功"}),this.imgUrl=e.data,this.dataList[this.curRowIndex].imgUrl=e.data},uploadimgTagSuccess:function(e){this.form.imgTag=e.data},uploadStandTagSuccess:function(e){this.form.standTag=e.data},formatPrice:function(e,t){return(e.salePrice/100).toFixed(2)},formatPrice2:function(e,t){return(e.officialPrice/100).toFixed(2)},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleSizeChangeGood:function(e){this.checkParam.pageSize=e,this.getGoodsList()},handleCurrentChange:function(e){this.pageNum=e,this.getList()},handleCurrentChangeGood:function(e){this.checkParam.pageNum=e,this.getGoodsList()},setNomal:function(e,t){var a=this,o={expandId:e.expandId,isDefault:t};s.a.setIsDefault(o).then(function(e){a.$message({type:"success",message:e.message}),a.getList()}).catch()},reset:function(){this.checkParam={bannerId:"",categoryOne:"",categoryTwo:"",categoryThree:"",title:"",status:"",pageNum:2,pageSize:20}},release:function(){var e=this,t={};t.goodsSortReqDTOs=JSON.parse(n()(e.goodsDataList)),s.a.sortHaitaoGoods(t).then(function(t){e.$message({type:"success",message:t.message}),e.getGoodsList()}).catch()}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getList}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")])],1)],1),e._v(" "),a("section",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",align:"center"}},[a("el-table-column",{attrs:{prop:"name",align:"center",label:"专场名称",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"imgUrl",align:"center",label:"标题背景图",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{attrs:{width:"120px",src:t.row.imgUrl,alt:""}}),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{headers:e.uploadHeader,action:e.uploadUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.curRowIndex=t.$index}}},[e._v("重新上传")])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sourceFrom",align:"center",label:"专场时间配置"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间",align:"right"},model:{value:t.row.startTime,callback:function(a){e.$set(t.row,"startTime",a)},expression:"scope.row.startTime"}}),e._v(" "),a("br"),e._v("\n            l\n            "),a("br"),e._v(" "),a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间",align:"right"},model:{value:t.row.endTime,callback:function(a){e.$set(t.row,"endTime",a)},expression:"scope.row.endTime"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sourceFrom",align:"center",label:"选品",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(a){e.selectBtn(t.row)}}},[e._v("选品")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sourceFrom",align:"center",label:"图片标签",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(a){e.editLine(t.row)}}},[e._v("编辑图片标签")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.nowShow?a("el-button",{attrs:{type:"text"}},[e._v("正在启用")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"medium",type:"success"},on:{click:function(a){e.updateLine(t.row,1)}}},[e._v("保存")]),e._v(" "),1!==t.row.isDefault?a("el-button",{attrs:{size:"medium",type:"success"},on:{click:function(a){e.setNomal(t.row,1)}}},[e._v("设为默认")]):e._e(),e._v(" "),1===t.row.isDefault?a("el-button",{attrs:{size:"medium",type:"info"},on:{click:function(a){e.setNomal(t.row,-1)}}},[e._v("取消设为默认")]):e._e(),e._v(" "),0===t.row.status?a("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(a){e.enableLine(t.row,1)}}},[e._v("禁用")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(a){e.deleteLine(t.row,t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pagination other-pagination",attrs:{"current-page":e.currentPage,"page-sizes":[20,30,40,50],"page-size":e.pageSize,total:e.totalSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"选品",width:"92%",visible:e.showAddDialog,"close-on-click-modal":!1,"before-close":e.cancelAddGood},on:{"update:visible":function(t){e.showAddDialog=t}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"一级类目"}},[a("el-select",{attrs:{placeholder:"全部"},on:{change:function(t){e.getBrands2(t,e.checkParam.categoryOne)}},model:{value:e.checkParam.categoryOne,callback:function(t){e.$set(e.checkParam,"categoryOne",t)},expression:"checkParam.categoryOne"}},e._l(e.brands1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"二级类目"}},[a("el-select",{attrs:{placeholder:"全部"},on:{change:function(t){e.getBrands3(t,e.checkParam.categoryTwo)}},model:{value:e.checkParam.categoryTwo,callback:function(t){e.$set(e.checkParam,"categoryTwo",t)},expression:"checkParam.categoryTwo"}},e._l(e.brands2,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"三级类目"}},[a("el-select",{attrs:{placeholder:"全部"},model:{value:e.checkParam.categoryThree,callback:function(t){e.$set(e.checkParam,"categoryThree",t)},expression:"checkParam.categoryThree"}},e._l(e.brands3,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"状态："}},[a("el-select",{attrs:{placeholder:"全部"},model:{value:e.checkParam.status,callback:function(t){e.$set(e.checkParam,"status",t)},expression:"checkParam.status"}},e._l(e.statusArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getGoodsList}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.release}},[e._v("发布")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.goodsDataList,border:"",align:"center"}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",align:"center",width:"100",label:"折扣排序"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodImg",align:"center",label:"商品主图"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{width:"120px",src:e.row.goodImg,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sort",align:"center",width:"100",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.sort,callback:function(a){e.$set(t.row,"sort",a)},expression:"scope.row.sort"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"discount",align:"center",label:"折扣"}}),e._v(" "),a("el-table-column",{attrs:{prop:"salePrice",formatter:e.formatPrice,align:"center",label:"现售价"}}),e._v(" "),a("el-table-column",{attrs:{prop:"officialPrice",formatter:e.formatPrice2,align:"center",label:"原价"}}),e._v(" "),a("el-table-column",{attrs:{prop:"gtitle",align:"center",label:"产品大标题"}}),e._v(" "),a("el-table-column",{attrs:{prop:"secondCategoryName",align:"center",label:"二级类目"}}),e._v(" "),a("el-table-column",{attrs:{prop:"thirdCategoryName",align:"center",label:"三级类目"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){e.selectLine(t.row,1)}}},[e._v("已选入")]):e._e(),e._v(" "),-1===t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.selectLine(t.row,1)}}},[e._v("未选入")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.currentPageGood,"page-sizes":[20,30,40,50],"page-size":e.pageSize,total:e.totalSizeGood,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChangeGood,"current-change":e.handleCurrentChangeGood}})],1),e._v(" "),a("el-dialog",{attrs:{title:"专场图片标签详细功能配置",width:"92%",visible:e.showDialog,"close-on-click-modal":!1,"before-close":e.cancelAdd},on:{"update:visible":function(t){e.showDialog=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"图片样式"}},[a("el-radio-group",{model:{value:e.form.imgType,callback:function(t){e.$set(e.form,"imgType",t)},expression:"form.imgType"}},[a("el-radio",{attrs:{label:1}},[e._v("头部图片")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("背景图片")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"专场图片标签"}},[a("el-radio-group",{model:{value:e.form.imgTagStatus,callback:function(t){e.$set(e.form,"imgTagStatus",t)},expression:"form.imgTagStatus"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:-1}},[e._v("禁用")])],1),e._v(" "),a("el-input",{model:{value:e.form.imgTagText,callback:function(t){e.$set(e.form,"imgTagText",t)},expression:"form.imgTagText"}}),e._v(" "),a("img",{attrs:{width:"120px",src:e.form.imgTag,alt:""}}),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{headers:e.uploadHeader,action:e.uploadUrl,"show-file-list":!1,"on-success":e.uploadimgTagSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("重新上传")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"专场立够标签"}},[a("el-radio-group",{model:{value:e.form.standTagStatus,callback:function(t){e.$set(e.form,"standTagStatus",t)},expression:"form.standTagStatus"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:-1}},[e._v("禁用")])],1),e._v(" "),a("el-input",{model:{value:e.form.standTagText,callback:function(t){e.$set(e.form,"standTagText",t)},expression:"form.standTagText"}}),e._v(" "),a("img",{attrs:{width:"120px",src:e.form.standTag,alt:""}}),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{headers:e.uploadHeader,action:e.uploadUrl,"show-file-list":!1,"on-success":e.uploadStandTagSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("重新上传")])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")]),e._v(" "),a("el-button",{on:{click:e.cancelAdd}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(r,l,!1,function(e){a("sZBp")},"data-v-31fc8766",null);t.default=c.exports}});