webpackJsonp([90],{sMTk:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("c/Tr"),i=a.n(n),s=a("Dd8w"),l=a.n(s),o=a("V/8j"),r=a("NYxO"),c={name:"log",data:function(){return{list:null,listLoading:!0,currentPage:1,pageSize:20,totalPage:0,listQuery:{operationData:void 0,type:void 0},typeList:[{name:"登录",type:[6]},{name:"数据操作",type:[1,2,3,4,5]}],choonseLog:[]}},computed:l()({},Object(r.b)(["menus"])),created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.listLoading=!0,Object(o.d)({currentPage:this.currentPage,pageSize:this.pageSize}).then(function(t){e.list=t.dataList,e.totalPage=t.totalSize,e.currentPage=t.currentPage,e.pageSize=t.pageSize,e.listLoading=!1})},handleSizeChange:function(e){this.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.currentPage=e,this.fetchData()},handleSelectionChange:function(e){this.choonseLog=e},search:function(){var e=this;this.listLoading=!0,Object(o.d)({currentPage:this.currentPage,pageSize:this.pageSize,operationTypes:this.listQuery.type}).then(function(t){e.list=t.dataList,e.totalPage=t.totalSize,e.currentPage=t.currentPage,e.pageSize=t.pageSize,e.listLoading=!1})},deleteChooseLog:function(e){var t=this;e>0?Object(o.a)({id:e}).then(function(e){t.$message({message:"删除日志成功",type:"success"}),t.fetchData()}):this.$confirm("删除选中日志, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){var e=[];Array.isArray(t.choonseLog)&&i()(t.choonseLog).forEach(function(t){e.push(t.id)}),Object(o.a)({ids:e}).then(function(e){t.$message({message:"删除日志成功",type:"success"}),t.fetchData()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"operation-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.search(t)}},model:{value:e.listQuery.operationData,callback:function(t){e.$set(e.listQuery,"operationData",t)},expression:"listQuery.operationData"}}),e._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"选择操作类型"},model:{value:e.listQuery.type,callback:function(t){e.$set(e.listQuery,"type",t)},expression:"listQuery.type"}},e._l(e.typeList,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.type}})})),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!==e.menus.indexOf("system.log.delete"),expression:"menus.indexOf('system.log.delete')!==-1"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.deleteChooseLog}},[e._v("删除")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"序号",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.$index+1)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作人",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.userName)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作信息",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(" "+e._s(t.row.info))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作数据",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(" "+e._s(t.row.operationData))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作时间",width:"200",prop:"created_at",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-time"}),e._v(" "),a("span",[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),-1!==e.menus.indexOf("system.log.delete")?a("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"filter-item",attrs:{type:"danger",size:"small"},on:{click:function(a){e.deleteChooseLog(t.row.id)}}},[e._v("删除")])]}}])}):e._e()],1),e._v(" "),[a("div",{staticClass:"block page-container"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]],2)},staticRenderFns:[]},d=a("VU/8")(c,u,!1,null,null,null);t.default=d.exports}});