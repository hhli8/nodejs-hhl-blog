webpackJsonp([29],{HMjz:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("Dd8w"),r=a.n(o),i=a("Xxa5"),s=a.n(i),n=a("exGp"),l=a.n(n),g=a("vk9j"),c={name:"goods-shopCategory",mixins:[a("jZhI").a],data:function(){return{pageConfig:{currentPage:1,pageSize:20,total:null},seartchForm:{businessName:"小象买手",positionName:"交易市场首页tab类目"},positionList:[{typeName:"交易市场首页tab类目"}],businesList:[{typeName:"小象买手"}],categoryDataList:[],shopConfigType:1}},computed:{bannerIndexArr:function(){return this.categoryDataList.length}},mounted:function(){this.getCategoryList()},methods:{changeVal:function(){},addCategory:function(){this.categoryDataList.push({categoryName:"",goodsCount:"",sort:""})},handleDelCategory:function(t,e){var a=this,o=t.id;return l()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!o){t.next=3;break}return t.next=3,Object(g.a)(o);case 3:a.categoryDataList.splice(e,1),a.$message.success("删除成功!");case 5:case"end":return t.stop()}},t,a)}))()},getCategoryList:function(){var t=this;return l()(s.a.mark(function e(){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.c)(r()({},t.seartchForm,t.pageConfig));case 2:a=e.sent,t.pageConfig.total=t.pageConfig.total?t.pageConfig.total:a.totalSize,t.categoryDataList=a.dataList;case 5:case"end":return e.stop()}},e,t)}))()},editCategoryStatus:function(t){var e=this;return l()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(g.b)({cid:t.id,status:1===t.status?0:1});case 2:t.status=1===t.status?0:1,e.$message.success("修改类目状态成功");case 4:case"end":return a.stop()}},a,e)}))()},editCategory:function(t){var e=this;return l()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(g.g)(r()({},e.seartchForm,t));case 2:e.$message.success("保存成功");case 3:case"end":return a.stop()}},a,e)}))()}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"padding-wrap"},[a("div",{staticClass:"form-box"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"所属业务"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.changeVal},model:{value:t.seartchForm.businessName,callback:function(e){t.$set(t.seartchForm,"businessName",e)},expression:"seartchForm.businessName"}},t._l(t.businesList,function(t){return a("el-option",{key:t.typeName,attrs:{label:t.typeName,value:t.typeName}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"位置名称"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.changeVal},model:{value:t.seartchForm.positionName,callback:function(e){t.$set(t.seartchForm,"positionName",e)},expression:"seartchForm.positionName"}},t._l(t.positionList,function(t){return a("el-option",{key:t.typeName,attrs:{label:t.typeName,value:t.typeName}})}))],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addCategory}},[t._v("新增类目")])],1)],1),t._v(" "),a("div",{staticClass:"table-list"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.categoryDataList,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"类目名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{model:{value:e.row.categoryName,callback:function(a){t.$set(e.row,"categoryName",a)},expression:"scope.row.categoryName"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"goodsCount",label:"商品数量",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"排列顺序"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{model:{value:e.row.sort,callback:function(a){t.$set(e.row,"sort",a)},expression:"scope.row.sort"}},t._l(t.bannerIndexArr,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(a){t.editCategory(e.row)}}},[t._v("保存")]),t._v(" "),a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(a){t.setCategoryShop(e.row.id)}}},[t._v("配置商品")]),t._v(" "),a("el-button",{attrs:{size:"medium",type:1===e.row.status?"danger":"primary"},on:{click:function(a){t.editCategoryStatus(e.row)}}},[t._v("\n              "+t._s(1===e.row.status?"禁用":"启用")+"\n            ")]),t._v(" "),a("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(a){t.handleDelCategory(e.row,e.$index)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("div",{staticClass:"margin-wrap pagination-wrap"},[a("el-pagination",{attrs:{background:"","current-page":t.pageConfig.currentPage,"page-sizes":[10,20,30,40,50],"page-size":t.pageConfig.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.pageConfig.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"配置商品",visible:t.dialogFormVisible,width:"90%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.dialogSetCategoryShopForm,inline:!0}},[a("el-form-item",{attrs:{label:"一级类目","label-width":"120"}},[a("el-select",{attrs:{size:"mini",placeholder:"请选择一级类目"},on:{change:t.dialogCategoryChangeOne},model:{value:t.dialogSetCategoryShopForm.gGategory1,callback:function(e){t.$set(t.dialogSetCategoryShopForm,"gGategory1",e)},expression:"dialogSetCategoryShopForm.gGategory1"}},t._l(t.dialogCategoryList.oneCategory,function(t){return a("el-option",{key:t.id,attrs:{label:t.categoryName,value:JSON.stringify({id:t.id,value:t.categoryName})}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"二级类目","label-width":"120"}},[a("el-select",{attrs:{size:"mini",placeholder:"请选择二级类目"},on:{change:t.dialogCategoryChangeTwo},model:{value:t.dialogSetCategoryShopForm.gGategory2,callback:function(e){t.$set(t.dialogSetCategoryShopForm,"gGategory2",e)},expression:"dialogSetCategoryShopForm.gGategory2"}},t._l(t.dialogCategoryList.twoCategory,function(t){return a("el-option",{key:t.id,attrs:{label:t.categoryName,value:JSON.stringify({id:t.id,value:t.categoryName})}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"三级类目","label-width":"120"}},[a("el-select",{attrs:{size:"mini",placeholder:"请选择三级类目"},model:{value:t.dialogSetCategoryShopForm.gGategory3,callback:function(e){t.$set(t.dialogSetCategoryShopForm,"gGategory3",e)},expression:"dialogSetCategoryShopForm.gGategory3"}},t._l(t.dialogCategoryList.threeCategory,function(t){return a("el-option",{key:t.id,attrs:{label:t.categoryName,value:JSON.stringify({id:t.id,value:t.categoryName})}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"商家名","label-width":"120"}},[a("el-input",{attrs:{size:"mini"},model:{value:t.dialogSetCategoryShopForm.shopName,callback:function(e){t.$set(t.dialogSetCategoryShopForm,"shopName",e)},expression:"dialogSetCategoryShopForm.shopName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"商品名称","label-width":"120"}},[a("el-input",{attrs:{size:"mini"},model:{value:t.dialogSetCategoryShopForm.goodsName,callback:function(e){t.$set(t.dialogSetCategoryShopForm,"goodsName",e)},expression:"dialogSetCategoryShopForm.goodsName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"商品编号","label-width":"120"}},[a("el-input",{attrs:{size:"mini"},model:{value:t.dialogSetCategoryShopForm.gId,callback:function(e){t.$set(t.dialogSetCategoryShopForm,"gId",e)},expression:"dialogSetCategoryShopForm.gId"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.clearShopForm}},[t._v("重置")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.getDiaLogShopList(1)}}},[t._v("查询")])],1)],1),t._v(" "),a("div",{staticClass:"flex flex-right",staticStyle:{"margin-bottom":"10px"}},[a("div",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.setGoodsStatus(t.seleShopGid,0)}}},[t._v("批量上架")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.setGoodsStatus(t.seleShopGid,1)}}},[t._v("批量下架")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.reloadShopDailog}},[t._v("刷新")])],1)]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.shopDataList,border:"",height:"400"},on:{"selection-change":t.catgoryShopSeleChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"gId",label:"商品编号",width:"140","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"gTitle",label:"商品名称",width:"240","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"gImg",label:"商品主图",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{height:"60px"},attrs:{src:t.row.gImg,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"purchasePrice",label:"起批价"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(t._f("priceFilter")(e.row.purchasePrice)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"suggestPrice",label:"建议零售价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(t._f("priceFilter")(e.row.suggestPrice)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"gPrice",label:"售价"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(t._f("priceFilter")(e.row.gPrice)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"gGategory1",label:"类目",width:"200","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.gGategory1)+"-"+t._s(e.row.gGategory2)+"-"+t._s(e.row.gGategory3))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"shopName",label:"商家名称",width:"200","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"gRate",label:"返佣比例"}}),t._v(" "),a("el-table-column",{attrs:{prop:"freight",label:"运费"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(t._f("priceFilter")(e.row.freight)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"monthVolume",label:"30天成交量(1688)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"skuCount",label:"sku",widtt:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.getShopSkuList(e.row.gId)}}},[t._v(t._s(e.row.skuCount)+"组sku")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"goodsStatus",label:"上架状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(0===e.row.goodsStatus?"上架中":"已下架"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.setGoodsStatus(e.row.gId,0===e.row.goodsStatus?1:0)}}},[t._v(t._s(0===e.row.goodsStatus?"下架":"上架"))])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{width:"90%",title:"sku详情",visible:t.dialogShopSkuDetails,"append-to-body":""},on:{"update:visible":function(e){t.dialogShopSkuDetails=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.shopSkuDataList,border:"",height:"350"}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"skuCode",label:"sku编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"skuStrs",label:"sku属性",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{width:"100px"},attrs:{src:t.row.gImg,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"contractPrice",label:"起批价"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(t._f("priceFilter")(e.row.contractPrice)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"skuPrice",label:"售价"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(t._f("priceFilter")(e.row.skuPrice)))])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"margin-wrap pagination-wrap"},[a("el-pagination",{attrs:{background:"","current-page":t.dialogPageConfig.pageNum,"page-sizes":[10,20,30,40,50],"page-size":t.dialogPageConfig.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.dialogPageConfig.total},on:{"size-change":t.handleDailogShopSizeChange,"current-change":t.handleDailogShopCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(c,u,!1,function(t){a("caKv")},"data-v-4d09f85a",null);e.default=d.exports},caKv:function(t,e){},jZhI:function(t,e,a){"use strict";var o=a("Dd8w"),r=a.n(o),i=a("Xxa5"),s=a.n(i),n=a("Gu7T"),l=a.n(n),g=a("exGp"),c=a.n(g),u=a("vk9j"),d=a("vLgD");function p(t){return Object(d.a)({url:"/msgoods/banner/getGoodsList",method:"POST",str:!0,data:t})}var m={data:function(){return{shopDataList:[],shopSkuDataList:[],dialogFormVisible:!1,dialogShopSkuDetails:!1,dialogPageConfig:{pageNum:1,pageSize:20,total:null},dialogSetCategoryShopForm:{gGategory1:"全部",gGategory2:"全部",gGategory3:"全部",status:2,shopName:"",goodsName:"",gId:""},seleShopGid:[],dialogCategoryList:{oneCategory:[{categoryName:"全部",id:"-1"}],twoCategory:[{categoryName:"全部",id:"-1"}],threeCategory:[{categoryName:"全部",id:"-1"}]}}},watch:{dialogFormVisible:function(t){t&&this.getCategoryDailogList({type:"oneCategory"})}},methods:{categoryShopFormInit:function(){this.dialogSetCategoryShopForm={gGategory1:"全部",gGategory2:"全部",gGategory3:"全部",shopName:"",goodsName:"",gId:"",status:2}},reloadShopDailog:function(){this.categoryShopFormInit(),this.lastQueryStatus=!1,this.dialogPageConfig.pageNum=1,this.getDiaLogShopList()},setBazaarCategoryShop:function(t){this.dialogFormVisible=!0,this.setbannerId=t,this.shopDataList=[],this.reloadShopDailog()},setCategoryShop:function(t){this.dialogFormVisible=!0,this.setCategoryId=t,this.shopDataList=[],this.reloadShopDailog()},getCategoryDailogList:function(t){var e=this,a=t.id,o=t.type;return c()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.d)(a);case 2:r=t.sent,e.dialogCategoryList[o]=[].concat(l()(e.dialogCategoryList[o]),l()(r.data));case 4:case"end":return t.stop()}},t,e)}))()},getDiaLogShopList:function(t){var e=this;return c()(s.a.mark(function a(){var o,i;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(1===t&&(e.dialogPageConfig.pageNum=1),(o=r()({},e.dialogSetCategoryShopForm,e.dialogPageConfig,{categoryName1:"",categoryName2:"",categoryName3:"",status:2})).categoryId=e.setCategoryId,o.bannerId=e.setbannerId,e.dialogSetCategoryShopForm.gGategory1.indexOf("{")>-1&&(o.categoryName1=JSON.parse(e.dialogSetCategoryShopForm.gGategory1).value),e.dialogSetCategoryShopForm.gGategory2.indexOf("{")>-1&&(o.categoryName2=JSON.parse(e.dialogSetCategoryShopForm.gGategory2).value),e.dialogSetCategoryShopForm.gGategory3.indexOf("{")>-1&&(o.categoryName3=JSON.parse(e.dialogSetCategoryShopForm.gGategory3).value),(1===t||e.lastQueryStatus)&&(o.status=1,e.lastQueryStatus=!0),i=void 0,1!==e.shopConfigType){a.next=15;break}return a.next=12,Object(u.e)(o);case 12:i=a.sent,a.next=18;break;case 15:return a.next=17,p(o);case 17:i=a.sent;case 18:e.dialogPageConfig.total=i.totalSize,e.shopDataList=i.dataList;case 20:case"end":return a.stop()}},a,e)}))()},dialogCategoryChangeOne:function(t){var e=JSON.parse(t).id;this.dialogCategoryList.twoCategory=[{categoryName:"全部",id:"-1"}],this.dialogSetCategoryShopForm.gGategory2="全部",this.dialogSetCategoryShopForm.gGategory3="全部",this.getCategoryDailogList({id:e,type:"twoCategory"})},dialogCategoryChangeTwo:function(t){var e=JSON.parse(t).id;this.dialogCategoryList.threeCategory=[{categoryName:"全部",id:"-1"}],this.dialogSetCategoryShopForm.gGategory3="全部",this.getCategoryDailogList({id:e,type:"threeCategory"})},changeVal:function(){},addCategory:function(){this.categoryDataList.push({categoryName:"",goodsCount:"",sort:""})},getShopSkuList:function(t){var e=this;return c()(s.a.mark(function a(){var o;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.dialogShopSkuDetails=!0,a.next=3,Object(u.f)({goodsCode:t});case 3:o=a.sent,e.shopSkuDataList=o.data;case 5:case"end":return a.stop()}},a,e)}))()},setGoodsStatus:function(t,e){var a=this,o="下架",r="string"==typeof t?1:t.length;0!==r?(0===e&&(o="上架"),this.$confirm("确认"+(r>1?"批量":"")+o+"这"+r+"个商品吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(c()(s.a.mark(function i(){return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(1!==a.shopConfigType){i.next=5;break}return i.next=3,Object(u.h)({categoryId:a.setCategoryId,goodsCodes:r>1?t.join():t,goodsStatus:e});case 3:i.next=7;break;case 5:return i.next=7,s={bannerId:a.setbannerId,goodsCodes:r>1?t.join():t,goodsStatus:e},void 0,void 0,void 0,n=s.bannerId,l=s.goodsCodes,g=s.goodsStatus,Object(d.a)({url:"/msgoods/banner/upperOrLowerGoods",method:"POST",str:!0,data:{bannerId:n,goodsCodes:l,goodsStatus:g}});case 7:a.$message.success(o+"成功"),a.getDiaLogShopList();case 9:case"end":return i.stop()}var s,n,l,g},i,a)})))):this.$message.error("请选择商品在进行上下架操作!")},clearShopForm:function(){for(var t in this.dialogSetCategoryShopForm)this.dialogSetCategoryShopForm[t]=""},catgoryShopSeleChange:function(t){this.seleShopGid=t.map(function(t){return t.gId})},handleDailogShopSizeChange:function(t){this.dialogPageConfig.pageSize=t,this.getDiaLogShopList()},handleDailogShopCurrentChange:function(t){this.dialogPageConfig.pageNum=t,this.getDiaLogShopList()},handleSizeChange:function(t){this.pageConfig.pageSize=t,this.getCategoryList()},handleCurrentChange:function(t){this.pageConfig.currentPage=t,this.getCategoryList()},getOldVal:function(t){var e=this.tabledata[t];this.oldSort=e.bannerIndex,this.bannerId=e.id}}};e.a=m},vk9j:function(t,e,a){"use strict";e.c=function(t){var e=t.businessName,a=t.positionName,r=t.pageNum,i=void 0===r?1:r,s=t.pageSize,n=void 0===s?20:s;return Object(o.a)({url:"/msgoods/tab/getCategory",method:"get",params:{businessName:e,positionName:a,pageNum:i,pageSize:n}})},e.g=function(t){return Object(o.a)({url:"/msgoods/tab/saveCategory",method:"POST",params:t})},e.a=function(t){return console.log(t),Object(o.a)({url:"/msgoods/tab/delCategory",method:"POST",params:{cid:t}})},e.b=function(t){var e=t.cid,a=t.status;return Object(o.a)({url:"/msgoods/tab/modifyStatus",method:"POST",str:!0,data:{cid:e,status:a}})},e.d=function(t){return Object(o.a)({url:"/msgoods/categoryLinkage",method:"POST",params:{id:t}})},e.h=function(t){var e=t.categoryId,a=t.goodsCodes,r=t.goodsStatus;return Object(o.a)({url:"/msgoods/tab/upperOrLowerGoods",method:"POST",str:!0,data:{categoryId:e,goodsCodes:a,goodsStatus:r}})},e.e=function(t){return Object(o.a)({url:"/msgoods/tab/getGoodsList",method:"POST",str:!0,data:t})},e.f=function(t){return Object(o.a)({url:"/msgoods/getGsGoodSkuList",method:"POST",str:!0,data:t})};var o=a("vLgD")}});