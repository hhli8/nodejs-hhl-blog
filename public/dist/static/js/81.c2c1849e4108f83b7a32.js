webpackJsonp([81],{ZofI:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("rqx2"),i={name:"todayOffer",components:{Loading:o("voil").a},data:function(){return{dialogEditOrder:!1,loadingList:!1,activityTitle:"",showLoading:!1,multipleQueryGoodsTable:[],formInline:{},tableData3:[],multipleTable:[],brands:[],showAddGoodsDialog:!1,dialogDeleteVisible:!1,pageNum:1,pageSize:10,total:1,totalPage:0,currentPage:1,pageSizeDetail:10,pageNumDetail:1,totalDetail:1,totalPageDetail:0,currentPageDetail:1,detailParam:{sortFiled:"",asc:0,pageNum:1,pageSize:10},queryGoodsListparam:{categoryName:"",discountPriceLower:"",couponPriceLower:"",couponPriceUpper:"",discountPriceUpper:"",sortFiled:"",asc:0,goodsName:"",itemId:"",pageNum:1,pageSize:10},addGoodsList:[],tableData:[],dialogFormVisible:!1,formLabelWidth:"120px",pickerOptions1:{},editOrderform:{goodsConfigId:"",orderNum:""}}},created:function(){this.getCategory(),this.getDetail()},methods:{getCategory:function(){var e=this;a.a.getCategoryList({level:3}).then(function(t){e.brands=t.dataList}).catch()},getDetail:function(e){var t=this;t.detailParam.activityId=1,t.loadingList=!0,a.a.prefrenceList(t.detailParam).then(function(e){t.loadingList=!1,t.showLoading=!1,t.tableData3=e.dataList,t.totalPageDetail=e.totalSize,t.currentPageDetail=e.currentPage,t.pageSizeDetail=e.pageSize,t.totalDetail=e.totalSize}).catch()},addGoods:function(){this.showAddGoodsDialog=!0},query:function(){var e=this;a.a.prefrenceGoodsList(e.queryGoodsListparam).then(function(t){e.addGoodsList=t.dataList,e.totalPage=t.totalSize,e.currentPage=t.currentPage,e.pageSize=t.pageSize,e.total=t.totalSize}).catch()},saveGoods:function(){var e=this,t={activityId:1,specialGoodsDTOS:e.multipleQueryGoodsTable};a.a.saveGoodsList(t).then(function(t){200===t.code&&(e.getDetail(),e.showAddGoodsDialog=!1)}).catch()},cancelSaveGoods:function(){this.addGoodsList=[],this.showAddGoodsDialog=!1},deleteline:function(){for(var e=this,t={activityId:1,goodsConfigIds:"",shelves:-1},o=[],i=0;i<e.multipleTable.length;i++)o.push(e.multipleTable[i].goodsConfigId);t.goodsConfigIds=o.join(","),a.a.updateGoods(t).then(function(t){200===t.code&&(e.$message({type:"success",message:t.message}),e.dialogDeleteVisible=!1,e.getDetail())}).catch()},deleteGoods:function(){console.log(this.multipleTable),this.dialogDeleteVisible=!0},cancelAddGoodsDialog:function(){this.showAddGoodsDialog=!1},saveActivityGoods:function(){var e=this,t={activityId:e.activityId};a.a.refreshGoods(t).then(function(t){200===t.code&&e.$message({message:"活动发布成功",type:"success"})}).catch()},saveActivity:function(){},cancelActivity:function(){},handleSelectionChange:function(e){this.multipleTable=e},handleSelectionChangeGoods:function(e){this.multipleQueryGoodsTable=e},handleSizeChange:function(e){this.pageSize=e,this.queryGoodsListparam.pageSize=e,this.query()},handleCurrentChange:function(e){this.currentPageDe=e,this.queryGoodsListparam.pageNum=e,this.query()},handleSizeChangeDetail:function(e){this.pageSizeDetail=e,this.detailParam.pageSize=e,this.getDetail()},handleCurrentChangeDetail:function(e){this.currentPageDetail=e,this.detailParam.pageNum=e,this.getDetail()},editOrder:function(e){this.editOrderform.goodsConfigId=e.row.goodsConfigId,this.editOrderform.orderNum=e.row.orderNum,this.dialogEditOrder=!0,console.log(this.editOrderform)},saveOrder:function(){var e=this;a.a.updateOrder(e.editOrderform).then(function(t){e.getDetail(),e.dialogEditOrder=!1}).catch()},muti:function(e){return e.length>0?"el-button el-button--primary":"noClick"},sortClick:function(e){console.log(e),this.detailParam.sortFiled=e.prop,"descending"===e.order?this.detailParam.asc=0:this.detailParam.asc=1,this.getDetail()},sortChange:function(e){console.log(e),this.queryGoodsListparam.sortFiled=e.prop,"descending"===e.order?this.queryGoodsListparam.asc=0:this.queryGoodsListparam.asc=1,this.query()},reset:function(){this.queryGoodsListparam={categoryName:"",discountPriceLower:"",sortFiled:"",discountPriceUpper:"",couponPriceLower:"",couponPriceUpper:"",goodsName:"",itemId:"",pageNum:1,pageSize:10}}}},l={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-row",[o("p",{staticClass:"title"},[e._v(e._s(e.activityTitle))])]),e._v(" "),o("el-row",[o("h4",[e._v("商品配置")])]),e._v(" "),o("hr"),e._v(" "),o("section",[o("el-row",{staticStyle:{margin:"10px 0"}},[o("el-button",{attrs:{type:"primary"},on:{click:e.addGoods}},[e._v("添加商品")]),e._v(" "),o("el-button",{class:e.muti(e.multipleTable),attrs:{type:"danger",icon:"el-icon-delete",disabled:0==e.multipleTable.length},on:{click:e.deleteGoods}},[e._v("删除商品")])],1)],1),e._v(" "),o("section",[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData3,"tooltip-effect":"dark"},on:{"sort-change":e.sortClick,"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),e._v(" "),o("el-table-column",{attrs:{prop:"itemId",align:"center",label:"商品ID"}}),e._v(" "),o("el-table-column",{attrs:{prop:"title",align:"center",label:"商品名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"picUrl",align:"center",label:"商品图片",width:"120"},scopedSlots:e._u([{key:"default",fn:function(e){return[o("img",{staticStyle:{height:"100px"},attrs:{src:e.row.picUrl,alt:""}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"categoryName",label:"商品分类",align:"center","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"price",label:"商品原价",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.price/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"discountPrice",label:"券后价",align:"center",sortable:"discountPrice","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.discountPrice/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"couponPrice",label:"优惠券",align:"center",sortable:"couponPrice","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.couponPrice/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"orderNum",label:"商品顺序",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.orderNum))]),o("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(o){e.editOrder(t)}}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"couponStartTime",label:"优惠券开始时间",align:"center","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"couponEndTime",label:"优惠券结束时间",align:"center","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"status",align:"center",label:"商品状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[o("span",[e._v(e._s(1===t.row.status?"上架":"下架"))])])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"couponStatus",label:"券状态",align:"center",sortable:"couponStatus","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"salesVolume",label:"淘宝销量",align:"center",sortable:"salesVolume","show-overflow-tooltip":""}})],1),e._v(" "),o("div",{staticClass:"pagination-container"},[o("el-pagination",{attrs:{background:"","current-page":e.currentPageDetail,"page-sizes":[10,20,30,40],"page-size":e.pageSizeDetail,layout:"total, sizes, prev, pager, next",total:e.totalDetail},on:{"size-change":e.handleSizeChangeDetail,"current-change":e.handleCurrentChangeDetail}})],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"添加商品",width:"92%",visible:e.showAddGoodsDialog,"close-on-click-modal":!1,"before-close":e.cancelAddGoodsDialog},on:{"update:visible":function(t){e.showAddGoodsDialog=t}}},[o("section",[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.queryGoodsListparam}},[o("el-form-item",[o("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择商品分类"},model:{value:e.queryGoodsListparam.categoryName,callback:function(t){e.$set(e.queryGoodsListparam,"categoryName",t)},expression:"queryGoodsListparam.categoryName"}},e._l(e.brands,function(e){return o("el-option",{key:e.id,attrs:{label:e.categoryName,value:e.categoryName}})}))],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.queryGoodsListparam.goodsName,callback:function(t){e.$set(e.queryGoodsListparam,"goodsName",t)},expression:"queryGoodsListparam.goodsName"}})],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{placeholder:"请输入商品编号"},model:{value:e.queryGoodsListparam.itemId,callback:function(t){e.$set(e.queryGoodsListparam,"itemId",t)},expression:"queryGoodsListparam.itemId"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"券后价区间"}},[o("el-col",{attrs:{span:11}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.discountPriceLower,callback:function(t){e.$set(e.queryGoodsListparam,"discountPriceLower",t)},expression:"queryGoodsListparam.discountPriceLower"}})],1),e._v(" "),o("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),o("el-col",{attrs:{span:11}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.discountPriceUpper,callback:function(t){e.$set(e.queryGoodsListparam,"discountPriceUpper",t)},expression:"queryGoodsListparam.discountPriceUpper"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"优惠券价区间"}},[o("el-col",{attrs:{span:11}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.couponPriceLower,callback:function(t){e.$set(e.queryGoodsListparam,"couponPriceLower",t)},expression:"queryGoodsListparam.couponPriceLower"}})],1),e._v(" "),o("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),o("el-col",{attrs:{span:11}},[o("el-input",{attrs:{placeholder:"请输入数字"},model:{value:e.queryGoodsListparam.couponPriceUpper,callback:function(t){e.$set(e.queryGoodsListparam,"couponPriceUpper",t)},expression:"queryGoodsListparam.couponPriceUpper"}})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),e._v(" "),o("section",[o("el-table",{ref:"multipleQueryGoodsTable",staticStyle:{width:"100%"},attrs:{data:e.addGoodsList,border:"",align:"center"},on:{"selection-change":e.handleSelectionChangeGoods,"sort-change":e.sortChange}},[o("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"itemId",align:"center",label:"商品编号"}}),e._v(" "),o("el-table-column",{attrs:{prop:"title",align:"center",label:"商品名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"picUrl",align:"center",label:"商品图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[o("img",{staticStyle:{height:"100px"},attrs:{src:e.row.picUrl,alt:""}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"categoryName",align:"center",label:"商品分类"}}),e._v(" "),o("el-table-column",{attrs:{prop:"price",align:"center",label:"商品原价"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.price/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"discountPrice",align:"center",sortable:"discountPrice",label:"券后价"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.discountPrice/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"couponPrice",align:"center",sortable:"couponPrice",label:"优惠券"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",[e._v(e._s((t.row.couponPrice/100).toFixed(2)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"status",label:"优惠券有效期","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v("开始"+e._s(t.row.couponStartTime))]),o("br"),o("span",[e._v("结束"+e._s(t.row.couponEndTime))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"salesVolume",align:"center",sortable:"salesVolume",label:"淘宝销量"}})],1),e._v(" "),o("div",{staticClass:"pagination-container"},[o("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),o("hr"),e._v(" "),o("el-row",[o("el-button",{on:{click:e.cancelSaveGoods}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.saveGoods}},[e._v("确定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.dialogDeleteVisible,width:"30%"},on:{"update:visible":function(t){e.dialogDeleteVisible=t}}},[o("span",[e._v("您确认删除选中的商品吗？")]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogDeleteVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.deleteline}},[e._v("确 定")])],1)]),e._v(" "),o("el-dialog",{attrs:{title:"修改排序：",width:"40%",visible:e.dialogEditOrder},on:{"update:visible":function(t){e.dialogEditOrder=t}}},[o("el-form",{attrs:{model:e.editOrderform}},[o("el-form-item",{attrs:{label:"排序值:","label-width":e.formLabelWidth}},[o("el-input",{attrs:{type:"number",placeholder:"请输入数字",autocomplete:"off"},model:{value:e.editOrderform.orderNum,callback:function(t){e.$set(e.editOrderform,"orderNum",t)},expression:"editOrderform.orderNum"}}),e._v(" "),o("p",{staticStyle:{color:"red"}},[e._v("排序值越大越靠前")])],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogEditOrder=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.saveOrder}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=o("VU/8")(i,l,!1,function(e){o("xf+O")},"data-v-223b848d",null);t.default=r.exports},"xf+O":function(e,t){}});