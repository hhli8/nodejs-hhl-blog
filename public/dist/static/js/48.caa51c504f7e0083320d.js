webpackJsonp([48],{NwcA:function(e,t){},hzkL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Xxa5"),l=a.n(n),i=a("exGp"),o=a.n(i),r=a("XpEf"),s={name:"",components:{uploadImgOnly:a("ypB/").a},props:{},data:function(){return{derive:!1,pageSize:10,totalSize:40,currentPage:1,operationListLoading:!1,iconUploadUrl:"http://localhost:8088/vain/api/upload/uploadPic",searchData:{opeType:"",name:"",status:""},opreationLocationOptions:[{label:"颜世界列表",value:1},{label:"关注列表",value:2},{label:"附近列表",value:3},{label:"图文详情推荐列表",value:4},{label:"话题主页笔记列表",value:6},{label:"位置主页笔记列表",value:7},{label:"品牌主页笔记列表",value:8},{label:"影视主页笔记列表",value:9},{label:"搜索结果页列表",value:17},{label:"标题",value:18}],operationList:[],newEditFormDialogVisible:!1,newEditformLabelAlign:{id:"",opeName:"",imgUrl:"",opeButton:"",opeTitle:"",headUrl:"",nickName:"",opeLikeButton:!1,opeLikeCount:"",opeOrder:"",opeUrl:"",status:"",opeType:""},newEditrules:{opeType:[{required:!0,message:"请选择运营位位置",trigger:"blur"}],opeName:[{required:!0,message:"请输入运营位名称",trigger:"blur"}],imgUrl:[{required:!0,message:"请上传图片",trigger:"blur"}],opeButton:[{required:!0,message:"请选择按钮展示状态",trigger:"blur"}],opeOrder:[{required:!0,message:"请输入运营位顺序",trigger:"blur"}]}}},computed:{},mounted:function(){this._apiGetOperationList()},methods:{beforeClose:function(e,t,a){this.resetEditForm(t,a)},locationOptionFilter:function(e){var t=this.opreationLocationOptions.filter(function(t){return t.value===e});return t.length?t[0].label:""},resetOperationDialogData:function(){for(var e in this.newEditformLabelAlign)this.newEditformLabelAlign[e]="opeLikeButton"!==e&&""},resetEditForm:function(e,t){this.$refs.uploadImg.clearFiles(),this.$refs.uploadHeadImg.clearFiles(),this.$refs[e].resetFields(),this[t]=!1,this.resetOperationDialogData()},submitEditForm:function(e,t){var a,n=this;this.$refs[e].validate((a=o()(l.a.mark(function a(i){return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!i){a.next=7;break}return a.next=3,n._apiOperationSet();case 3:n._apiGetOperationList(),n.resetEditForm(e,t),a.next=9;break;case 7:return console.log("error submit!!"),a.abrupt("return",!1);case 9:case"end":return a.stop()}},a,n)})),function(e){return a.apply(this,arguments)}))},handleStatusChange:function(e,t){this._apiStatusChange({id:e.id,status:t})},handlerExport:function(){var e=this;return o()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._apiGetOperationList();case 2:e.totalSize>=5e4?e.$message.error("您将导出的数据超过50000条,可能会导致导出失败,请重新选择搜索条件"):(e.derive=!0,e._apiGetOperationList());case 3:case"end":return t.stop()}},t,e)}))()},handlerImgUpload:function(e,t){var a=this;return o()(l.a.mark(function n(){var i,o,r;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.file,(o=new FormData).append("file",i),n.next=5,a._apiUploadPic(o);case 5:r=n.sent,a.newEditformLabelAlign[t]=r;case 7:case"end":return n.stop()}},n,a)}))()},handlerRemoveUploadImg:function(e,t){this.newEditformLabelAlign[t]=""},handleOpenOperationEdit:function(e,t){var a=this;return o()(l.a.mark(function n(){var i;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e)a.resetOperationDialogData();else for(i in a.newEditformLabelAlign)a.newEditformLabelAlign.hasOwnProperty(i)&&(a.newEditformLabelAlign[i]=t[i]);a.newEditFormDialogVisible=!0;case 2:case"end":return n.stop()}},n,a)}))()},_apiOperationSet:function(){var e=this;return Object(r.u)(this.newEditformLabelAlign).then(function(t){e.$message({type:"success",message:"操作成功!"})}).catch(function(t){console.log(t),e.$message({type:"error",message:"操作失败!"})})},_apiUploadPic:function(e){return Object(r.K)(e).then(function(e){return e.data})},_apiGetOperationList:function(){var e=this;return this.operationListLoading=!0,Object(r.v)({opeType:this.searchData.opeType,name:this.searchData.name,status:this.searchData.status,currentPage:this.currentPage,derive:this.derive},this.derive).then(function(t){if(e.derive){var a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document;charset=utf-8"}),n=document.createElement("a"),l=window.URL.createObjectURL(a);n.href=l;n.download="运营位管理导出.xls",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(l),e.derive=!1}else e.operationList=t.dataList,e.pageSize=t.pageSize,e.totalSize=t.totalSize,e.currentPage=t.currentPage,e.operationListLoading=!1}).catch(function(t){e.derive&&(e.derive=!1),e.operationListLoading=!1,console.log(t)})},_apiStatusChange:function(e){var t=this;return Object(r.w)(e).then(function(e){t.$message({type:"success",message:"操作成功!"}),t._apiGetOperationList()})}}},c={render:function(){var e=this,t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"faceworldVideo"},[n("el-container",[n("el-header",{attrs:{height:"135px"}},[n("el-row",{staticClass:"header",attrs:{type:"flex",justify:"space-between"}},[n("el-col",[n("span",{staticStyle:{"line-height":"30px"}},[t._v("运营位管理")])]),t._v(" "),n("el-col",{staticClass:"right"},[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-plus"},on:{click:function(e){t.handleOpenOperationEdit(!0)}}},[t._v("新建")])],1)],1),t._v(" "),n("el-row",{staticClass:"videoContrlNav",attrs:{gutter:20}},[n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{placeholder:"请选择运营位位置",clearable:""},model:{value:t.searchData.opeType,callback:function(e){t.$set(t.searchData,"opeType",e)},expression:"searchData.opeType"}},t._l(t.opreationLocationOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),t._v(" "),n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{placeholder:"请输入运营位名称",clearable:""},model:{value:t.searchData.name,callback:function(e){t.$set(t.searchData,"name",e)},expression:"searchData.name"}})],1),t._v(" "),n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{placeholder:"请选择启用状态",clearable:""},model:{value:t.searchData.status,callback:function(e){t.$set(t.searchData,"status",e)},expression:"searchData.status"}},[n("el-option",{attrs:{label:"启用",value:1}}),t._v(" "),n("el-option",{attrs:{label:"停用",value:-1}})],1)],1),t._v(" "),n("el-col",{attrs:{span:5}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t._apiGetOperationList}},[t._v("查询")]),t._v(" "),n("el-button",{attrs:{plain:"",icon:"el-icon-upload2"},on:{click:t.handlerExport}},[t._v("导出")])],1)],1)],1),t._v(" "),n("el-main",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.operationListLoading,expression:"operationListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.operationList,stripe:""}},[n("el-table-column",{attrs:{type:"index",label:"序号","header-align":"center",align:"center",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{prop:"opeType",label:"运营位位置","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t"+t._s(t.locationOptionFilter(e.row.opeType))+"\n\t\t\t\t\t\t")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"opeName",label:"运营位名称","header-align":"center",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"userId",label:"图片","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-image",{staticStyle:{width:"150px",height:"150px"},attrs:{src:e.row.imgUrl,fit:"contain"},on:{click:function(a){t.$store.dispatch("openImgPreview",{url:e.row.imgUrl})}}})]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"opeOrder",label:"展示位置","header-align":"center",align:"center",sortable:""}}),t._v(" "),n("el-table-column",{attrs:{prop:"status",label:"启用状态","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t"+t._s(1===e.row.status?"启用":"停用")+"\n\t\t\t\t\t\t")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center",fixed:"right",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticClass:"optionBtn",attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleStatusChange(e.row,-2)}}},[t._v("删除")]),t._v(" "),n("el-button",{staticClass:"optionBtn",attrs:{size:"mini",type:1===e.row.status?"danger":"success"},on:{click:function(a){t.handleStatusChange(e.row,1===e.row.status?-1:1)}}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(1===e.row.status?"停用":"启用")+"\n\t\t\t\t\t\t\t")]),t._v(" "),n("el-button",{staticClass:"optionBtn",attrs:{size:"mini"},on:{click:function(a){t.handleOpenOperationEdit(!1,e.row)}}},[t._v("编辑")])]}}])})],1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.totalSize>0,expression:"totalSize>0"}],staticClass:"pagination-container"},[n("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":t.pageSize,layout:"prev, pager, next, jumper",total:t.totalSize},on:{"current-change":t._apiGetOperationList,"update:currentPage":function(e){t.currentPage=e}}})],1)],1),t._v(" "),n("el-dialog",{attrs:{visible:t.newEditFormDialogVisible,width:"550px",center:"","before-close":function(){t.resetEditForm("newEditForm","newEditFormDialogVisible")}},on:{"update:visible":function(e){t.newEditFormDialogVisible=e}}},[n("el-form",{ref:"newEditForm",attrs:{"label-position":"left","label-width":"100px",model:t.newEditformLabelAlign,rules:t.newEditrules}},[n("el-form-item",{attrs:{label:"运营位位置",prop:"opeType"}},[n("el-select",{attrs:{placeholder:"请选择运营位位置",clearable:""},model:{value:t.newEditformLabelAlign.opeType,callback:function(e){t.$set(t.newEditformLabelAlign,"opeType",e)},expression:"newEditformLabelAlign.opeType"}},t._l(t.opreationLocationOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),t._v(" "),n("el-form-item",{attrs:{label:"运营位名称",prop:"opeName"}},[n("el-input",{attrs:{placeholder:"请输入运营位名称",clearable:""},model:{value:t.newEditformLabelAlign.opeName,callback:function(e){t.$set(t.newEditformLabelAlign,"opeName",e)},expression:"newEditformLabelAlign.opeName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"图片",prop:"imgUrl"}},[n("upload-img-only",{ref:"uploadImg",attrs:{handleImgUploadSuccess:function(t){e.handlerImgUpload(t,"imgUrl")},uploadImgRemove:function(t){e.handlerRemoveUploadImg(t,"imgUrl")},imgUrl:t.newEditformLabelAlign.imgUrl}})],1),t._v(" "),n("el-form-item",{attrs:{label:"字段",prop:"opeButton"}},[n("el-input",{attrs:{placeholder:"请输入运营位字段",clearable:""},model:{value:t.newEditformLabelAlign.opeButton,callback:function(e){t.$set(t.newEditformLabelAlign,"opeButton",e)},expression:"newEditformLabelAlign.opeButton"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"标题",prop:"opeTitle"}},[n("el-input",{attrs:{placeholder:"请输入标题",clearable:""},model:{value:t.newEditformLabelAlign.opeTitle,callback:function(e){t.$set(t.newEditformLabelAlign,"opeTitle",e)},expression:"newEditformLabelAlign.opeTitle"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"头像",prop:"headUrl"}},[n("upload-img-only",{ref:"uploadHeadImg",attrs:{handleImgUploadSuccess:function(t){e.handlerImgUpload(t,"headUrl")},uploadImgRemove:function(t){e.handlerRemoveUploadImg(t,"headUrl")},imgUrl:t.newEditformLabelAlign.headUrl}})],1),t._v(" "),n("el-form-item",{attrs:{label:"昵称",prop:"nickName"}},[n("el-input",{attrs:{placeholder:"请输入用户昵称",clearable:""},model:{value:t.newEditformLabelAlign.nickName,callback:function(e){t.$set(t.newEditformLabelAlign,"nickName",e)},expression:"newEditformLabelAlign.nickName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"点赞按钮展示状态",prop:"opeLikeButton"}},[n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"展示"},model:{value:t.newEditformLabelAlign.opeLikeButton,callback:function(e){t.$set(t.newEditformLabelAlign,"opeLikeButton",e)},expression:"newEditformLabelAlign.opeLikeButton"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"点赞数",prop:"opeLikeCount"}},[n("el-input",{attrs:{placeholder:"请输入点赞数",type:"number",clearable:""},model:{value:t.newEditformLabelAlign.opeLikeCount,callback:function(e){t.$set(t.newEditformLabelAlign,"opeLikeCount",e)},expression:"newEditformLabelAlign.opeLikeCount"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"顺序",prop:"opeOrder"}},[n("el-input",{attrs:{placeholder:"请输入顺序",clearable:""},model:{value:t.newEditformLabelAlign.opeOrder,callback:function(e){t.$set(t.newEditformLabelAlign,"opeOrder",e)},expression:"newEditformLabelAlign.opeOrder"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"跳转地址",prop:"opeUrl"}},[n("el-input",{attrs:{placeholder:"请输入跳转地址",clearable:""},model:{value:t.newEditformLabelAlign.opeUrl,callback:function(e){t.$set(t.newEditformLabelAlign,"opeUrl",e)},expression:"newEditformLabelAlign.opeUrl"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.resetEditForm("newEditForm","newEditFormDialogVisible")}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitEditForm("newEditForm","newEditFormDialogVisible")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(s,c,!1,function(e){a("NwcA")},"data-v-e0ba60ec",null);t.default=p.exports}});