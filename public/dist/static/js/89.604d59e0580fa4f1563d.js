webpackJsonp([89],{F7rB:function(e,t){},KQfp:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("RRo+"),i=a.n(r),o=a("voil"),s=a("B4UA"),c=a("H3QE"),n={name:"newGoodsCategory",data:function(){return{showLoading:!1,dataList:[],showCreateDialog:!1,formLabelWidth:"150px",createObj:{title:"新建分类",orderNum:"",searchKey:"",categoryName:"",id:null,pageType:""},createObjrules:{categoryName:[{required:!0,message:"请输入类目名称",trigger:"blur"}],orderNum:[{required:!0,type:"number",message:"排序必须为数字值",trigger:"blur"}]},showDelDialog:!1,delId:null,currentPage:1,pageSize:10,totalSize:1,showCheck:!1,addPageType:[],isZKJX:!1}},created:function(){this.getShopGuidePageType()},mounted:function(){this.searchListServe()},methods:{chosePageType:function(e){this.isZKJX=2===e,this.$forceUpdate()},searchListServe:function(){var e=this;this.showLoading=!0,Object(s.g)({level:1,pageSize:this.pageSize,pageNum:this.currentPage}).then(function(t){e.showLoading=!1,e.dataList=t.dataList,e.currentPage=t.currentPage,e.pageSize=t.pageSize,e.totalSize=t.totalSize}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},goSecondList:function(e,t){this.$router.push({name:"categorySecondList",query:{parentId:t.id,categoryName:t.categoryName}})},openDelDialog:function(e,t){this.showDelDialog=!0,this.delId=t.id},openCreateDialog:function(e,t,a){"create"===e?(this.isZKJX=!1,this.createObj.title="新建分类",this.createObj.orderNum="",this.createObj.categoryName="",this.createObj.searchKey="",this.createObj.pageType=this.addPageType[0].dictionarieType,this.showCreateDialog=!0):"update"===e&&(this.createObj.title="编辑分类",this.createObj.orderNum=a.orderNum,this.createObj.searchKey=a.searchKey,this.createObj.categoryName=a.categoryName,this.createObj.pageType=a.pageType,this.createObj.id=a.id,this.showCreateDialog=!0,2===a.pageType?this.isZKJX=!0:this.isZKJX=!1)},cancelCreateDialog:function(){this.showCreateDialog=!1,this.$refs.createObjRef.resetFields(),this.createObj.title="新建分类",this.createObj.orderNum="",this.createObj.categoryName="",this.createObj.id=null},submitCreate:function(){return this.createObj.categoryName?this.createObj.orderNum?void this.checkCategoryServe(this.saveCategoryServe):this.$message.error("请输入排序值"):this.$message.error("请输入类目名称")},submitUpdate:function(){return this.createObj.categoryName?this.createObj.orderNum?void this.checkCategoryServe(this.modifyCategoryServe):this.$message.error("请输入排序值"):this.$message.error("请输入类目名称")},orderSeqChange:function(e){i()(Number(e))?e&&Number(e)<1?this.createObj.orderNum=1:Number(e)>999&&(this.createObj.orderNum=1):this.createObj.orderNum=""},saveCategoryServe:function(){var e=this;this.showLoading=!0,Object(s.f)({categoryName:this.createObj.categoryName,level:1,searchKey:2===this.createObj.pageType?this.createObj.searchKey:"",orderNum:+this.createObj.orderNum,pageType:this.createObj.pageType}).then(function(t){e.showLoading=!1,e.$message({message:"添加成功",type:"success"}),e.showCreateDialog=!1,e.$refs.createObjRef.resetFields(),e.searchListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},cancelDelDialog:function(){this.delId=null,this.showDelDialog=!1},submitDel:function(){var e=this;this.showLoading=!0,Object(s.b)(this.delId).then(function(t){e.showLoading=!1,e.showDelDialog=!1,e.$message({message:"删除成功",type:"success"}),e.delId=null,e.searchListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},modifyCategoryServe:function(){var e=this;this.showLoading=!0,Object(s.d)({categoryName:this.createObj.categoryName,level:1,searchKey:2===this.createObj.pageType?this.createObj.searchKey:"",id:this.createObj.id,orderNum:this.createObj.orderNum,pageType:this.createObj.pageType}).then(function(t){e.showLoading=!1,e.$message({message:"修改成功",type:"success"}),e.showCreateDialog=!1,e.createObj={title:"新建分类",orderNum:"",categoryName:"",id:null},e.searchListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},checkCategoryServe:function(e){var t=this;Object(s.a)(this.createObj.categoryName).then(function(a){a.data?e():t.$message.error("商品类⽬名称不可⽤")}).catch(function(e){t.$message.error(e)})},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.searchListServe()},handleCurrentChange:function(e){this.currentPage=e,this.searchListServe()},openCheck:function(){this.showCheck=!0},cancelCheckDialog:function(){this.showCheck=!1},getShopGuidePageType:function(){var e=this;Object(s.c)({}).then(function(t){var a=[];t.dataList.forEach(function(e,t){1!==e.dictionarieType&&a.push(e)}),e.addPageType=a}).catch(function(t){e.$message.error(t)})}},components:{Loading:o.a,check:c.a}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"newGoodsCategory"},[a("el-row",{staticClass:"classify-header",attrs:{type:"flex",justify:"space-between"}},[a("el-col",[a("span",{staticClass:"classify-title"},[e._v("搜券返利--商品分类列表")])]),e._v(" "),a("el-col",{staticClass:"tr"},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:function(t){e.openCreateDialog("create")}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{type:"warning",icon:"el-icon-check"},on:{click:e.openCheck}},[e._v("商品类⽬可⽤校验")])],1)],1),e._v(" "),a("el-row",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.showLoading,expression:"showLoading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:""}},[a("el-table-column",{attrs:{label:"编号",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"类目名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.categoryName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"排序",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.orderNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"设置",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.goSecondList(t.$index,t.row)}}},[e._v("二级分类管理")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"页面类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(2===t.row.pageType?"折扣精选":1===t.row.pageType?"搜券":"默认"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.openCreateDialog("update",t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.openDelDialog(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.createObj.title,visible:e.showCreateDialog,"close-on-click-modal":!1,"before-close":e.cancelCreateDialog,width:"40%"},on:{"update:visible":function(t){e.showCreateDialog=t}}},[a("el-form",{ref:"createObjRef",attrs:{model:e.createObj,rules:e.createObjrules}},[a("el-form-item",{attrs:{label:"类目名称","label-width":e.formLabelWidth,prop:"categoryName"}},[a("el-input",{attrs:{placeholder:"请输入类目名称"},model:{value:e.createObj.categoryName,callback:function(t){e.$set(e.createObj,"categoryName",t)},expression:"createObj.categoryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序","label-width":e.formLabelWidth,prop:"orderNum"}},[a("el-input",{attrs:{placeholder:"请输入排序"},on:{change:e.orderSeqChange},model:{value:e.createObj.orderNum,callback:function(t){e.$set(e.createObj,"orderNum",e._n("string"==typeof t?t.trim():t))},expression:"createObj.orderNum"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isZKJX,expression:"isZKJX"}],attrs:{label:"搜索关键词","label-width":e.formLabelWidth,prop:"searchKey"}},[a("el-input",{attrs:{placeholder:"请输入搜索关键词"},model:{value:e.createObj.searchKey,callback:function(t){e.$set(e.createObj,"searchKey",t)},expression:"createObj.searchKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"页面类型","label-width":e.formLabelWidth,prop:"orderNum"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.chosePageType},model:{value:e.createObj.pageType,callback:function(t){e.$set(e.createObj,"pageType",t)},expression:"createObj.pageType"}},e._l(e.addPageType,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictionarieName,value:e.dictionarieType}})}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelCreateDialog}},[e._v("取 消")]),e._v(" "),"新建分类"===e.createObj.title?a("el-button",{attrs:{type:"primary"},on:{click:e.submitCreate}},[e._v("确 定")]):e._e(),e._v(" "),"编辑分类"===e.createObj.title?a("el-button",{attrs:{type:"primary"},on:{click:e.submitUpdate}},[e._v("确 定")]):e._e()],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.showDelDialog,width:"30%",title:"删除该分类？","close-on-click-modal":!1,"before-close":e.cancelDelDialog},on:{"update:visible":function(t){e.showDelDialog=t}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelDelDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitDel}},[e._v("确 定")])],1)]),e._v(" "),a("check",{attrs:{showCheckDialog:e.showCheck},on:{cancelCheckDialog:e.cancelCheckDialog}})],1)},staticRenderFns:[]};var h=a("VU/8")(n,l,!1,function(e){a("F7rB")},"data-v-02af73c8",null);t.default=h.exports}});