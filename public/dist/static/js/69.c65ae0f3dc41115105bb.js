webpackJsonp([69],{"49h3":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("RRo+"),o=a.n(r),i=a("voil"),s=a("B4UA"),c=a("H3QE"),n={name:"categorySecondList",data:function(){return{showLoading:!1,dataList:[],formLabelWidth:"150px",createObj:{title:"新建分类",orderNum:"",categoryName:"",id:null},createObjrules:{categoryName:[{required:!0,message:"请输入二级类目名称",trigger:"blur"}],orderNum:[{required:!0,type:"number",message:"排序必须为数字值",trigger:"blur"}]},showCreateDialog:!1,showDelDialog:!1,delId:null,parentId:null,categoryName:null,currentPage:1,pageSize:10,totalSize:1,showCheck:!1}},mounted:function(){this.parentId=+this.$route.query.parentId,this.categoryName=this.$route.query.categoryName,this.searchListServe()},methods:{searchListServe:function(){var e=this;this.showLoading=!0,Object(s.g)({level:2,parentId:this.parentId,pageSize:this.pageSize,pageNum:this.currentPage}).then(function(t){e.showLoading=!1,e.dataList=t.dataList,e.currentPage=t.currentPage,e.pageSize=t.pageSize,e.totalSize=t.totalSize}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},openCreateDialog:function(e,t,a){"create"===e?(this.createObj.title="新建分类",this.createObj.orderNum="",this.createObj.categoryName="",this.showCreateDialog=!0):"update"===e&&(this.createObj.title="编辑分类",this.createObj.orderNum=a.orderNum,this.createObj.categoryName=a.categoryName,this.createObj.id=a.id,this.showCreateDialog=!0)},goThreeList:function(e,t){this.$router.push({name:"categoryThreeList",query:{parentId:t.id,categoryName:t.categoryName,fname:this.categoryName}})},cancelCreateDialog:function(){this.showCreateDialog=!1,this.$refs.createObjRef.resetFields(),this.createObj.title="新建分类",this.createObj.orderNum="",this.createObj.categoryName="",this.createObj.id=null},submitCreate:function(){return this.createObj.categoryName?this.createObj.orderNum?void this.checkCategoryServe(this.saveCategoryServe):this.$message.error("请输入排序值"):this.$message.error("请输入类目名称")},submitUpdate:function(){return this.createObj.categoryName?this.createObj.orderNum?void this.checkCategoryServe(this.modifyCategoryServe):this.$message.error("请输入排序值"):this.$message.error("请输入类目名称")},orderSeqChange:function(e){o()(Number(e))?e&&Number(e)<1?this.createObj.orderNum=1:Number(e)>999&&(this.createObj.orderNum=1):this.createObj.orderNum=""},saveCategoryServe:function(){var e=this;this.showLoading=!0,Object(s.f)({categoryName:this.createObj.categoryName,level:2,orderNum:+this.createObj.orderNum,parentId:this.parentId,pageType:0}).then(function(t){e.showLoading=!1,e.$message({message:"添加成功",type:"success"}),e.showCreateDialog=!1,e.$refs.createObjRef.resetFields(),e.searchListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},cancelDelDialog:function(){this.delId=null,this.showDelDialog=!1},submitDel:function(){var e=this;this.showLoading=!0,Object(s.b)(this.delId).then(function(t){e.showLoading=!1,e.showDelDialog=!1,e.$message({message:"删除成功",type:"success"}),e.delId=null,e.searchListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},openDelDialog:function(e,t){this.showDelDialog=!0,this.delId=t.id},checkCategoryServe:function(e){var t=this;Object(s.a)(this.createObj.categoryName).then(function(a){a.data?e():t.$message.error("商品类⽬名称不可⽤")}).catch(function(e){t.$message.error(e)})},modifyCategoryServe:function(){var e=this;this.showLoading=!0,Object(s.d)({categoryName:this.createObj.categoryName,level:2,id:this.createObj.id,orderNum:+this.createObj.orderNum,parentId:+this.parentId,pageType:0}).then(function(t){e.showLoading=!1,e.$message({message:"修改成功",type:"success"}),e.showCreateDialog=!1,e.createObj={title:"新建分类",orderNum:"",categoryName:"",id:null},e.searchListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.searchListServe()},handleCurrentChange:function(e){this.currentPage=e,this.searchListServe()},openCheck:function(){this.showCheck=!0},cancelCheckDialog:function(){this.showCheck=!1}},components:{Loading:i.a,check:c.a},watch:{$route:function(e,t){this.showLoading=!1,this.dataList=[],this.formLabelWidth="150px",this.createObj={title:"新建分类",orderNum:"",categoryName:"",id:null},this.createObjrules={categoryName:[{required:!0,message:"请输入二级类目名称",trigger:"blur"}],orderNum:[{required:!0,type:"number",message:"排序必须为数字值",trigger:"blur"}]},this.showCreateDialog=!1,this.showDelDialog=!1,this.delId=null,this.parentId=null,this.categoryName=null,this.currentPage=1,this.pageSize=10,this.totalSize=1,this.parentId=+this.$route.query.parentId,this.categoryName=this.$route.query.categoryName,this.searchListServe()}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"categorySecondList"},[a("el-row",{staticClass:"classify-header",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{md:15,sm:15}},[a("div",{staticClass:"classify-title"},[a("span",[e._v("搜券返利--二级分类列表")]),e._v(" "),a("span",{staticStyle:{color:"#409EFF"}},[e._v("("+e._s(e.categoryName)+")")])])]),e._v(" "),a("el-col",{attrs:{md:6,sm:6}},[a("el-button",{staticStyle:{margin:"10px 0"},attrs:{icon:"el-icon-plus",type:"primary"},on:{click:function(t){e.openCreateDialog("create")}}},[e._v("添加")]),e._v(" "),a("el-button",{staticStyle:{margin:"10px 0 0 10px"},attrs:{type:"primary"},on:{click:e.openCheck}},[e._v("商品类⽬可⽤校验")])],1)],1),e._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList}},[a("el-table-column",{attrs:{label:"编号",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"类目名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.categoryName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"父类目名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.pCategoryName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"排序",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.orderNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"设置",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.goThreeList(t.$index,t.row)}}},[e._v("三级分类管理")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.openCreateDialog("update",t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.openDelDialog(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("el-row",{staticStyle:{margin:"30px 0px 0px 0"}},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.createObj.title,visible:e.showCreateDialog,"close-on-click-modal":!1,"before-close":e.cancelCreateDialog,width:"40%"},on:{"update:visible":function(t){e.showCreateDialog=t}}},[a("el-form",{ref:"createObjRef",attrs:{model:e.createObj,rules:e.createObjrules}},[a("el-form-item",{attrs:{label:"二级类目名称","label-width":e.formLabelWidth,prop:"categoryName"}},[a("el-input",{attrs:{placeholder:"请输入二级类目名称"},model:{value:e.createObj.categoryName,callback:function(t){e.$set(e.createObj,"categoryName",t)},expression:"createObj.categoryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序","label-width":e.formLabelWidth,prop:"orderNum"}},[a("el-input",{attrs:{placeholder:"请输入排序"},on:{change:e.orderSeqChange},model:{value:e.createObj.orderNum,callback:function(t){e.$set(e.createObj,"orderNum",e._n("string"==typeof t?t.trim():t))},expression:"createObj.orderNum"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelCreateDialog}},[e._v("取 消")]),e._v(" "),"新建分类"===e.createObj.title?a("el-button",{attrs:{type:"primary"},on:{click:e.submitCreate}},[e._v("确 定")]):e._e(),e._v(" "),"编辑分类"===e.createObj.title?a("el-button",{attrs:{type:"primary"},on:{click:e.submitUpdate}},[e._v("确 定")]):e._e()],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.showDelDialog,width:"30%",title:"删除该分类？","close-on-click-modal":!1,"before-close":e.cancelDelDialog},on:{"update:visible":function(t){e.showDelDialog=t}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelDelDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitDel}},[e._v("确 定")])],1)]),e._v(" "),a("Loading",{directives:[{name:"show",rawName:"v-show",value:e.showLoading,expression:"showLoading"}]}),e._v(" "),a("check",{attrs:{showCheckDialog:e.showCheck},on:{cancelCheckDialog:e.cancelCheckDialog}})],1)},staticRenderFns:[]};var h=a("VU/8")(n,l,!1,function(e){a("KfIm")},"data-v-51204bf1",null);t.default=h.exports},KfIm:function(e,t){}});