webpackJsonp([23],{"/IEV":function(e,t){},eVZE:function(e,t,a){"use strict";var n=a("RRo+"),o=a.n(n),i=a("Dd8w"),r=a.n(i),s=a("voil"),l=a("yu3o"),c=a("TIfe"),d=a("LLYX"),u={name:"newSecond",data:function(){return{showLoading:!1,formLabelWidth:"150px",createNewSecondObj:{},uploadFileList:[],createNewBrandObjrules:{name:[{required:!0,message:"请输入二级分类名称",trigger:"blur"}],orderSeq:[{type:"number",message:"排序必须为数字值,不填默认999",trigger:"blur"}]},selectList:[],selectSpecial:"",brandList:[],selectBrand:""}},methods:{cancelNewSecondDialog:function(){this.$emit("cancelNewSecondDialog"),this.createNewSecondObj={},this.$refs.newSecond.resetFields()},handlerBanerImg:function(e){this.createNewSecondObj.bannerUrl=e},handlerIconImg:function(e){this.createNewSecondObj.icon=e},submitNewBrand:function(){this.insertServe()},queryAllSpecialServe:function(){var e=this;Object(l.f)().then(function(t){e.selectList=t.data})},queryBrandByIdServe:function(){var e=this;Object(l.g)({id:this.parentId}).then(function(t){e.brandList=t.data})},insertServe:function(){var e=this;this.showLoading=!0;var t=this.createNewSecondObj,a=r()({},t,{type:2,parentId:this.parentId});t.orderSeq?a.orderSeq=+t.orderSeq:a.orderSeq=999,Object(l.d)(a).then(function(a){for(var n in e.showLoading=!1,e.$message({message:"新建成功",type:"success"}),e.$emit("serveSuccess"),t)t[n]=t[n];e.$refs.newSecond.resetFields()}).catch(function(t){e.showLoading=!1,e.$message.error(t),e.$emit("cancelNewSecondDialog")})},updateServe:function(){var e=this;this.showLoading=!0;var t=this.createNewSecondObj,a=r()({},t,{type:2,parentId:this.parentId});Object(l.j)(a).then(function(a){for(var n in e.showLoading=!1,e.$message({message:"修改成功",type:"success"}),e.$emit("serveSuccess"),e.$emit("serveSuccess"),t)t[n]=t[n];e.$refs.newSecond.resetFields()}).catch(function(t){e.showLoading=!1,e.$message.error(t),e.$emit("cancelNewSecondDialog"),e.$refs.newSecond.resetFields()})},updateNewBrand:function(){this.updateServe()},orderSeqChange:function(e){o()(Number(e))?e&&Number(e)<1?this.createNewSecondObj.orderSeq=1:Number(e)>999&&(this.createNewSecondObj.orderSeq=999):this.createNewSecondObj.orderSeq=""},handleRemove:function(e,t){0===t.length&&(this.createNewSecondObj.bannerUrl="")},handleSuccess:function(e,t,a){a.length>1&&a.splice(0,1),200===e.code?this.createNewSecondObj.bannerUrl=e.data:this.$message("图片上传失败,"+(e.message||e.errorMsg))},handleError:function(e,t,a){this.$message("文件上传失败: "+String(e))}},props:{showNewSecondDialog:{type:Boolean,default:!1},parentId:{type:[String,Number]},inputBrandId:{type:[String,Number]},type:{type:String,default:"create"},inputSetObj:{type:Object}},watch:{showNewSecondDialog:function(e){e?(this.selectSpecial=this.parentId,"update"===this.type&&(this.createNewSecondObj=r()({},this.inputSetObj),this.uploadFileList=[{name:"",url:this.createNewSecondObj.bannerUrl}])):this.createNewSecondObj={}},uploadFileList:function(e){var t=this.uploadFileList,a=this.createNewSecondObj;a&&(t.length>0?a.bannerUrl=t[0].url:a&&(a.bannerUrl=""))}},computed:{dialogTitle:function(){return"update"===this.type?"编辑分类":"新增分类"},uploadUrl:function(){return"https://www.xiaoxiangyoupin.com/xxyp-manager/upload/uploadPic"},uploadHeader:function(){return{Token:Object(c.c)()}}},components:{Loading:s.a,imgUp:d.a}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"newSecond"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.showNewSecondDialog,"close-on-click-modal":!1,"before-close":e.cancelNewSecondDialog},on:{"update:visible":function(t){e.showNewSecondDialog=t}}},[a("el-form",{ref:"newSecond",attrs:{model:e.createNewSecondObj,rules:e.createNewBrandObjrules}},[a("el-form-item",{attrs:{label:"专题名称","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入专题名称"},model:{value:e.createNewSecondObj.specialName,callback:function(t){e.$set(e.createNewSecondObj,"specialName","string"==typeof t?t.trim():t)},expression:"createNewSecondObj.specialName"}}),e._v(" "),a("el-tag",{attrs:{type:"danger"}},[e._v("专题名称用于前台展示")])],1),e._v(" "),a("el-form-item",{attrs:{label:"分类名称","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入分类名称"},model:{value:e.createNewSecondObj.categoryName,callback:function(t){e.$set(e.createNewSecondObj,"categoryName","string"==typeof t?t.trim():t)},expression:"createNewSecondObj.categoryName"}}),e._v(" "),a("el-tag",{attrs:{type:"danger"}},[e._v("分类名称用于搜索引擎")])],1),e._v(" "),a("el-form-item",{attrs:{label:"排序","label-width":e.formLabelWidth,prop:"orderSeq"}},[a("el-input",{attrs:{placeholder:"请输入排序,不填默认999",min:"1",max:"999"},on:{change:e.orderSeqChange},model:{value:e.createNewSecondObj.orderSeq,callback:function(t){e.$set(e.createNewSecondObj,"orderSeq",e._n("string"==typeof t?t.trim():t))},expression:"createNewSecondObj.orderSeq"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"banner图url","label-width":e.formLabelWidth,prop:"bannerUrl"}},[a("div",{staticClass:"upload-file-wrap"},[a("imgUp",{attrs:{type:"movable",inputObj:{imgUrl:e.createNewSecondObj.bannerUrl}},on:{emiturl:e.handlerBanerImg}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"二级分类icon","label-width":e.formLabelWidth,prop:"bannerUrl"}},[a("div",{staticClass:"upload-file-wrap"},[a("imgUp",{attrs:{type:"movable",inputObj:{imgUrl:e.createNewSecondObj.icon}},on:{emiturl:e.handlerIconImg}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"\t副标题","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入内容"},model:{value:e.createNewSecondObj.subtitle,callback:function(t){e.$set(e.createNewSecondObj,"subtitle","string"==typeof t?t.trim():t)},expression:"createNewSecondObj.subtitle"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelNewSecondDialog}},[e._v("取 消")]),e._v(" "),"update"===e.type?a("el-button",{attrs:{type:"primary"},on:{click:e.updateNewBrand}},[e._v("确 定")]):a("el-button",{attrs:{type:"primary"},on:{click:e.submitNewBrand}},[e._v("确 定")])],1)],1),e._v(" "),a("Loading",{directives:[{name:"show",rawName:"v-show",value:e.showLoading,expression:"showLoading"}]})],1)},staticRenderFns:[]};var p=a("VU/8")(u,h,!1,function(e){a("/IEV")},"data-v-ce63138c",null);t.a=p.exports},nOou:function(e,t){},sDTu:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("yu3o"),o=a("voil"),i=a("eVZE"),r={name:"secondList",data:function(){return{showLoading:!1,brandId:"",parentId:"",tableData:[],currentPage:1,totalPage:1,totalSize:1,pageSize:10,showNewSecondDialog:!1,showDelDialog:!1,delObj:{},newSecondType:"create",setObj:null,showPreviewGoodsDialog:!1,pgObj:{barId:null,pageSize:10,currentPage:1,totalSize:1},previewGoodsList:[],fname:""}},created:function(){this.fname=this.$route.query.fname},mounted:function(){this.parentId=+this.$route.query.parentId,this.parentId&&this.queryBarListServe()},methods:{handleSizeChange:function(e){this.pageSize=e,this.queryBarListServe()},handleCurrentChange:function(e){this.currentPage=e,this.queryBarListServe()},queryBarListServe:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;this.showLoading=!0,Object(n.h)({currentPage:this.currentPage,pageSize:this.pageSize,parentId:this.parentId,type:t}).then(function(t){e.showLoading=!1,e.currentPage=t.currentPage,e.totalPage=t.totalPage,e.totalSize=t.totalSize;var a=t.dataList;e.formatList(a)}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},formatList:function(e){var t=e;t.forEach(function(e){e.statusBool=!1,e.statusBool=1===Number(e.status)}),this.tableData=t},cancelNewSecondDialog:function(){this.showNewSecondDialog=!1},newSecondServeSuccess:function(){this.showNewSecondDialog=!1,this.queryBarListServe()},openNewSecondCreateDialog:function(e){this.newSecondType=e,this.showNewSecondDialog=!0},openNewSecondDialog:function(e,t,a){this.newSecondType=e,this.setObj=a,this.showNewSecondDialog=!0},openDelDialog:function(e,t){this.delObj={parentId:this.parentId,id:t.id},this.showDelDialog=!0},submitDel:function(){this.delServe(),this.showDelDialog=!1},cancelDelDialog:function(){this.delObj={},this.showDelDialog=!1},delServe:function(){var e=this;this.showLoading=!0,Object(n.b)({id:this.delObj.id}).then(function(t){e.showLoading=!1,e.$message({message:"删除成功",type:"success"}),e.queryBarListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},updateServe:function(){var e=this;this.showLoading=!0,Object(n.j)({name:this.delObj.name,parentId:this.brandId,status:this.delObj.status,id:this.delObj.id}).then(function(t){e.showLoading=!1,e.$message({message:"删除成功",type:"success"}),e.delObj={},e.queryBarListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},switchChange:function(e,t){var a=this;this.showLoading=!0,Object(n.j)({id:t.id,name:t.name,status:t.statusBool?1:0}).then(function(e){a.showLoading=!1,a.$message({message:"修改成功",type:"success"}),a.queryBarListServe()}).catch(function(e){a.showLoading=!1,a.$message.error(e)})},openPreviewGoodsDialog:function(e,t){this.pgObj.barId=t.id,this.previewGoodsServe(),this.showPreviewGoodsDialog=!0},cancelPreviewGoodsDialog:function(){this.showPreviewGoodsDialog=!1,this.pgObj={barId:null,pageSize:10,currentPage:1,totalSize:1}},previewGoodsServe:function(){var e=this;this.showLoading=!0,Object(n.e)({brandId:this.brandId,barId:this.pgObj.barId,pageSize:this.pgObj.pageSize,currentPage:this.pgObj.currentPage}).then(function(t){e.showLoading=!1,e.previewGoodsList=t.dataList||[],e.pgObj.pageSize=t.pageSize,e.pgObj.totalPage=t.totalPage,e.pgObj.totalSize=t.totalSize}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},PGhandleSizeChange:function(e){this.pgObj.pageSize=e,this.previewGoodsServe()},PGhandleCurrentChange:function(e){this.pgObj.currentPage=e,this.previewGoodsServe()}},watch:{$route:function(e,t){this.showLoading=!1,this.brandId="",this.parentId="",this.tableData=[],this.currentPage=1,this.totalPage=1,this.totalSize=1,this.pageSize=10,this.showNewSecondDialog=!1,this.showDelDialog=!1,this.delObj={},this.newSecondType="create",this.setObj={},this.showPreviewGoodsDialog=!1,this.pgObj={barId:null,pageSize:10,currentPage:1,totalSize:1},this.previewGoodsList=[],this.fname="",this.fname=this.$route.query.fname,this.brandId=+this.$route.query.brandId,this.parentId=+this.$route.query.parentId,this.brandId&&this.parentId&&this.queryBarListServe()}},components:{Loading:o.a,newSecond:i.a}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"secondList"},[a("el-row",{staticClass:"classify-header",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{md:22,sm:21}},[a("div",{staticClass:"classify-title"},[a("span",[e._v("二级分类管理")]),e._v(" "),a("span",{staticStyle:{color:"#409EFF"}},[e._v("("+e._s(e.fname)+")")])])]),e._v(" "),a("el-col",{attrs:{md:2,sm:3}},[a("el-button",{staticStyle:{margin:"10px 0"},attrs:{icon:"el-icon-plus",type:"primary"},on:{click:function(t){e.openNewSecondCreateDialog("create")}}},[e._v("添加")])],1)],1),e._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"center","cell-class-name":"center href-link"}},[a("el-table-column",{attrs:{label:"编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"二级品类名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.categoryName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"二级品类icon"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("div",{staticClass:"banner-wrap"},[a("img",{attrs:{src:e.row.icon}})])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"专题名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.specialName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"banner"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("div",{staticClass:"banner-wrap"},[a("img",{attrs:{src:e.row.bannerUrl}})])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"品牌数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[a("router-link",{attrs:{to:{name:"brandList",query:{id:t.row.id,fname:t.row.categoryName}}}},[e._v(e._s(t.row.brandCount))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否显示"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{on:{change:function(a){e.switchChange(t.$index,t.row)}},model:{value:t.row.statusBool,callback:function(a){e.$set(t.row,"statusBool",a)},expression:"scope.row.statusBool"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.orderSeq))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.openNewSecondDialog("update",t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.openDelDialog(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("el-row",{staticStyle:{margin:"30px 0px 0px 0"}},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{visible:e.showDelDialog,width:"30%",title:"删除该分类？","close-on-click-modal":!1,"before-close":e.cancelDelDialog},on:{"update:visible":function(t){e.showDelDialog=t}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelDelDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitDel}},[e._v("确 定")])],1)]),e._v(" "),a("Loading",{directives:[{name:"show",rawName:"v-show",value:e.showLoading,expression:"showLoading"}]}),e._v(" "),a("newSecond",{attrs:{showNewSecondDialog:e.showNewSecondDialog,parentId:e.parentId,inputBrandId:e.brandId,type:e.newSecondType,inputSetObj:e.setObj},on:{cancelNewSecondDialog:e.cancelNewSecondDialog,serveSuccess:e.newSecondServeSuccess}}),e._v(" "),a("el-dialog",{attrs:{visible:e.showPreviewGoodsDialog,width:"70%",title:"预览商品","close-on-click-modal":!1,"before-close":e.cancelPreviewGoodsDialog},on:{"update:visible":function(t){e.showPreviewGoodsDialog=t}}},[a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.previewGoodsList,height:"500px"}},[a("el-table-column",{attrs:{label:"标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.title))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"skuId",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.skuId))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"标价",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.price/100))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{height:"80px"},attrs:{src:e.row.img,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"来源",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.pForm))])]}}])})],1)],1),e._v(" "),a("el-row",{staticStyle:{margin:"30px 0px 0px 0"}},[a("el-pagination",{attrs:{"current-page":e.pgObj.currentPage,"page-sizes":[10,15,20,30],"page-size":e.pgObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pgObj.totalSize},on:{"size-change":e.PGhandleSizeChange,"current-change":e.PGhandleCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(r,s,!1,function(e){a("nOou")},"data-v-47ea0cf1",null);t.default=l.exports}});