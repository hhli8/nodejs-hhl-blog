webpackJsonp([14],{"6IBi":function(e,t){},BHcq:function(e,t){},RBYa:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("RRo+"),r=a.n(i),o=a("voil"),s=a("B4UA"),n=a("Tlht"),l=a("H3QE"),c={name:"categoryThreeList",data:function(){return{showLoading:!1,parentId:null,categoryName:"",fname:"",dataList:[],formLabelWidth:"150px",createObj:{title:"新建分类",orderNum:"",categoryName:"",id:null,icon:"",searchKey:""},createObjrules:{categoryName:[{required:!0,message:"请输入三级类目名称",trigger:"blur"}],orderNum:[{required:!0,type:"number",message:"排序必须为数字值",trigger:"blur"}]},showCreateDialog:!1,showDelDialog:!1,delId:null,currentPage:1,pageSize:10,totalSize:1,showCheck:!1}},mounted:function(){this.parentId=+this.$route.query.parentId,this.categoryName=this.$route.query.categoryName,this.fname=this.$route.query.fname,this.searchListServe()},methods:{searchListServe:function(){var e=this;this.showLoading=!0,Object(s.e)({level:3,pageSize:this.pageSize,pageNum:this.currentPage}).then(function(t){e.showLoading=!1,e.dataList=t.dataList,e.currentPage=1,e.pageSize=1,e.totalSize=1}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},cancelCreateDialog:function(){this.showCreateDialog=!1,this.$refs.createObjRef.resetFields(),this.createObj.title="新建分类",this.createObj.orderNum="",this.createObj.categoryName="",this.createObj.id=null,this.createObj.icon="",this.createObj.searchKey=""},submitCreate:function(){return this.createObj.categoryName?this.createObj.orderNum?this.createObj.icon?void this.checkCategoryServe(this.saveCategoryServe):this.$message.error("请上传图片"):this.$message.error("请输入排序值"):this.$message.error("请输入类目名称")},submitUpdate:function(){return this.createObj.categoryName?this.createObj.orderNum?this.createObj.icon?void this.checkCategoryServe(this.modifyCategoryServe):this.$message.error("请上传图片"):this.$message.error("请输入排序值"):this.$message.error("请输入类目名称")},orderSeqChange:function(e){r()(Number(e))?e&&Number(e)<1?this.createObj.orderNum=1:Number(e)>999&&(this.createObj.orderNum=1):this.createObj.orderNum=""},openCreateDialog:function(e,t,a){"create"===e?(this.createObj.title="新建分类",this.createObj.orderNum="",this.createObj.categoryName="",this.createObj.icon="",this.createObj.searchKey="",this.showCreateDialog=!0):"update"===e&&(this.createObj.title="编辑分类",this.createObj.orderNum=a.orderNum,this.createObj.categoryName=a.categoryName,this.createObj.id=a.id,this.createObj.icon=a.icon,this.createObj.searchKey=a.searchKey,this.showCreateDialog=!0)},emitLogoUrl:function(e){this.createObj.icon=e},modifyCategoryServe:function(){var e=this;this.showLoading=!0,Object(s.d)({categoryName:this.createObj.categoryName,level:3,id:this.createObj.id,parentId:0,orderNum:+this.createObj.orderNum,icon:this.createObj.icon,searchKey:this.createObj.searchKey,pageType:1}).then(function(t){e.showLoading=!1,e.$message({message:"修改成功",type:"success"}),e.showCreateDialog=!1,e.createObj={title:"新建分类",orderNum:"",categoryName:"",id:null,icon:"",searchKey:""},e.searchListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},checkCategoryServe:function(e){var t=this;Object(s.a)(this.createObj.categoryName).then(function(a){a.data?e():t.$message.error("商品类⽬名称不可⽤")}).catch(function(e){t.$message.error(e)})},saveCategoryServe:function(){var e=this;this.showLoading=!0,Object(s.f)({categoryName:this.createObj.categoryName,level:3,orderNum:+this.createObj.orderNum,parentId:0,icon:this.createObj.icon,searchKey:this.createObj.searchKey,pageType:1}).then(function(t){e.showLoading=!1,e.$message({message:"添加成功",type:"success"}),e.showCreateDialog=!1,e.$refs.createObjRef.resetFields(),e.searchListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},cancelDelDialog:function(){this.delId=null,this.showDelDialog=!1},submitDel:function(){var e=this;this.showLoading=!0,Object(s.b)(this.delId).then(function(t){e.showLoading=!1,e.showDelDialog=!1,e.$message({message:"删除成功",type:"success"}),e.delId=null,e.searchListServe()}).catch(function(t){e.showLoading=!1,e.$message.error(t)})},openDelDialog:function(e,t){this.showDelDialog=!0,this.delId=t.id},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.searchListServe()},handleCurrentChange:function(e){this.currentPage=e,this.searchListServe()},openCheck:function(){this.showCheck=!0},cancelCheckDialog:function(){this.showCheck=!1}},components:{Loading:o.a,imgUp:n.a,check:l.a},watch:{$route:function(e,t){this.showLoading=!1,this.parentId=null,this.categoryName="",this.fname="",this.dataList=[],this.formLabelWidth="150px",this.createObj={title:"新建分类",orderNum:"",categoryName:"",id:null,icon:"",searchKey:""},this.createObjrules={categoryName:[{required:!0,message:"请输入三级类目名称",trigger:"blur"}],orderNum:[{required:!0,type:"number",message:"排序必须为数字值",trigger:"blur"}]},this.showCreateDialog=!1,this.showDelDialog=!1,this.delId=null,this.currentPage=1,this.pageSize=10,this.totalSize=1,this.parentId=+this.$route.query.parentId,this.categoryName=this.$route.query.categoryName,this.fname=this.$route.query.fname,this.searchListServe()}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"categoryThreeList"},[a("el-row",{staticClass:"classify-header",attrs:{type:"flex"}},[a("el-col",[a("div",{staticClass:"classify-title"},[a("span",[e._v("搜券返利--搜券分类")]),e._v(" "),a("span",{staticStyle:{color:"#409EFF"}},[e._v("("+e._s(e.fname)+"-"+e._s(e.categoryName)+")")])])]),e._v(" "),a("el-col",{staticClass:"tr"},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:function(t){e.openCreateDialog("create")}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{type:"warning",icon:"el-icon-check"},on:{click:e.openCheck}},[e._v("商品类⽬可⽤校验")])],1)],1),e._v(" "),a("el-row",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.showLoading,expression:"showLoading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:""}},[a("el-table-column",{attrs:{label:"编号",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"类目名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.categoryName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"图片",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.row.icon,fit:"contain"},on:{click:function(a){e.$store.dispatch("openImgPreview",{url:t.row.icon})}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"排序",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.orderNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"父类目名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.pCategoryName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"搜索词",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.searchKey))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.openCreateDialog("update",t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.openDelDialog(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.totalSize,expression:"totalSize"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.createObj.title,visible:e.showCreateDialog,"close-on-click-modal":!1,"before-close":e.cancelCreateDialog,width:"40%"},on:{"update:visible":function(t){e.showCreateDialog=t}}},[a("el-form",{ref:"createObjRef",attrs:{model:e.createObj,rules:e.createObjrules}},[a("el-form-item",{attrs:{label:"三级类目名称","label-width":e.formLabelWidth,prop:"categoryName"}},[a("el-input",{attrs:{placeholder:"请输入三级类目名称"},model:{value:e.createObj.categoryName,callback:function(t){e.$set(e.createObj,"categoryName",t)},expression:"createObj.categoryName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上传图片","label-width":e.formLabelWidth,prop:"orderNum"}},[a("imgUp",{attrs:{type:"movable",inputObj:{index:e.createObj.id,imgUrl:e.createObj.icon}},on:{emiturl:e.emitLogoUrl}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序","label-width":e.formLabelWidth,prop:"orderNum"}},[a("el-input",{attrs:{placeholder:"请输入排序"},on:{change:e.orderSeqChange},model:{value:e.createObj.orderNum,callback:function(t){e.$set(e.createObj,"orderNum",e._n("string"==typeof t?t.trim():t))},expression:"createObj.orderNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"搜索词","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入搜索词"},model:{value:e.createObj.searchKey,callback:function(t){e.$set(e.createObj,"searchKey","string"==typeof t?t.trim():t)},expression:"createObj.searchKey"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelCreateDialog}},[e._v("取 消")]),e._v(" "),"新建分类"===e.createObj.title?a("el-button",{attrs:{type:"primary"},on:{click:e.submitCreate}},[e._v("确 定")]):e._e(),e._v(" "),"编辑分类"===e.createObj.title?a("el-button",{attrs:{type:"primary"},on:{click:e.submitUpdate}},[e._v("确 定")]):e._e()],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.showDelDialog,width:"30%",title:"删除该分类？","close-on-click-modal":!1,"before-close":e.cancelDelDialog},on:{"update:visible":function(t){e.showDelDialog=t}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelDelDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitDel}},[e._v("确 定")])],1)]),e._v(" "),a("check",{attrs:{showCheckDialog:e.showCheck},on:{cancelCheckDialog:e.cancelCheckDialog}})],1)},staticRenderFns:[]};var u=a("VU/8")(c,h,!1,function(e){a("6IBi")},"data-v-0c8a7d24",null);t.default=u.exports},Tlht:function(e,t,a){"use strict";var i=a("B4UA"),r={props:["type","inputObj"],data:function(){return{showDialog:!1,uploadValue:{name:"",wh:""},uploadSrc:"",isUploading:!1}},methods:{beforeUpload:function(e){if(!(e.size/1024<2048))return this.showDialog=!1,this.$message.error("上传图片大小不能超过 2MB!"),this.$refs[this.inputObj.index+"movable"].clearFiles(),!1},open2:function(){this.$message({message:"图片上传成功",type:"success"})},open4:function(e){this.$message.error("图片上传失败"+e)},uploadUrl:function(){return"http://localhost:8088/xxyp-manager/upload/uploadPic"},handleAvatarSuccess:function(e,t){},myImgUpload:function(e){var t=this;this.isUploading=!0;var a=e.file,r=new FormData;return r.append("file",a),Object(i.h)(r).then(function(e){t.open2();var a=e.data;t.$emit("emiturl",a),t.uploadValue={name:"",wh:""},t.uploadSrc="",t.showDialog=!1,t.isUploading=!1,console.log(t.$refs),t.$refs[t.inputObj.index+"movable"].clearFiles()}).catch(function(e){t.open4(e),t.showDialog=!1,t.isUploading=!1,t.$refs[t.inputObj.index+"movable"].clearFiles()}),!1},fileChange:function(e,t){console.log("change"),console.log(e),this.uploadSrc=e.url;var a=new Image;a.src=e.url;var i=this;a.onload=function(){i.uploadValue={name:e.name,wh:"图片宽高为："+a.width+" X "+a.height},i.showDialog=!0}},saveAndCommit:function(e){this.isUploading||this.$refs[e].submit()},isupload:function(e){var t=/^http/.test(e);return t},cancelImgUp:function(e){this.uploadSrc="",this.showDialog=!1,this.uploadValue={name:"",wh:""},this.$refs[this.inputObj.index+"movable"].clearFiles()},onlyOne:function(e,t){console.log(e,t)}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"imgup"},[[a("img",{staticClass:"avatar",class:{bgc:e.isupload(e.inputObj.imgUrl)},attrs:{src:e.inputObj.imgUrl||""}}),e._v(" "),"movable"===e.type?a("el-upload",{ref:e.inputObj.index+"movable",staticClass:"upload-demo",attrs:{"before-upload":e.beforeUpload,action:e.uploadUrl(),"show-file-list":!1,accept:".jpg,.jpeg,.png","on-success":e.handleAvatarSuccess,"auto-upload":!1,"http-request":e.myImgUpload,"on-change":e.fileChange,limit:1,data:{refName:e.inputObj.index+"movable"}}},[a("el-button",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.inputObj.imgUrl?"重新上传":"上传"))])],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"图片上传",visible:e.showDialog,width:"50%",modal:!1,customClass:"newbrandimgdialog"},on:{"update:visible":function(t){e.showDialog=t}}},[a("h5",[e._v(e._s(e.uploadValue.name))]),e._v(" "),a("h5",[e._v(e._s(e.uploadValue.wh))]),e._v(" "),a("div",{staticClass:"seeImg"},[a("img",{staticClass:"imgstyle",attrs:{src:e.uploadSrc,alt:""}})]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancelImgUp(e.inputObj.index+"bjimgup")}}},[e._v("取 消")]),e._v(" "),"movable"===e.type?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveAndCommit(e.inputObj.index+"movable")}}},[e._v("上传图片")]):e._e()],1)])]],2)},staticRenderFns:[]};var s=a("VU/8")(r,o,!1,function(e){a("BHcq"),a("lAWh")},"data-v-7d11fac8",null);t.a=s.exports},lAWh:function(e,t){}});