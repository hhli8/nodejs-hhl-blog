webpackJsonp([72],{EA0T:function(e,t){},oapx:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("oedn"),n={name:"brandAndGoods",components:{Loading:a("voil").a},data:function(){return{showLoading:!1,page:{value:"全球好货",typeId:1,options:[{name:"全球好货",id:1},{name:"品牌馆",id:2}]},lists:[],grade1:[],currentPage:1,pagesize:10,totalSize:0,timeout:null}},watch:{},created:function(){var e=this;this.load(),o.a.globalGetCategoryList({parentId:0}).then(function(t){e.grade1=t.data})},methods:{load:function(){var e=this;this.showLoading=!0,o.a.globalListCategory({type:this.page.typeId,pageNum:this.currentPage,pageSize:this.pagesize}).then(function(t){e.lists=t.dataList,e.totalSize=t.totalSize,e.lists.map(function(t,a){return e.$set(e.lists[a],"grade1Val",t.firstCategoryName),e.$set(e.lists[a],"grade2Val",t.secondCategoryName),e.$set(e.lists[a],"grade3Val",t.thirdCategoryName),t}),e.showLoading=!1}).catch(function(){e.showLoading=!1})},getCategory:function(e,t){o.a.globalGetCategoryList({parentId:e}).then(function(e){t(e)})},indexMethod:function(e){return e+1+(this.currentPage-1)*this.pagesize},chosePage:function(e){this.page.typeId=e,this.load()},addNewCt:function(){this.lists.unshift({grade1Val:"",grade2:[],grade2Val:"",grade3:[],grade3Val:"",name:"",id:""})},handleSizeChange:function(e){this.pagesize=e,this.load()},handleCurrentChange:function(e){this.currentPage=e,this.load()},doDelete:function(e){var t=this;e.id?(this.showLoading=!0,o.a.globalDelete({id:e.id}).then(function(e){t.showLoading=!1,t.load()}).catch(function(){t.showLoading=!1})):this.lists.shift()},save:function(e){var t=this;if(e.id)this.update(e);else{if(!e.sort)return void this.$message({message:"排序需要是两位数"});this.showLoading=!0,o.a.globalAdd({type:this.page.typeId,firstCategory:e.firstCategory,secondCategory:e.secondCategory,thirdCategory:e.thirdCategory,customCategory:e.customCategory,sort:e.sort}).then(function(e){t.showLoading=!1,t.load()}).catch(function(){t.showLoading=!1})}},setUse:function(e,t){this.update(e,t)},update:function(e,t){var a=this;e.sort?(this.showLoading=!0,o.a.globalUpdateCategory({id:e.id,type:"全球好货"===this.page.value?1:2,firstCategory:e.firstCategory,secondCategory:e.secondCategory,thirdCategory:e.thirdCategory,customCategory:e.customCategory,sort:e.sort,status:t||e.status}).then(function(e){a.showLoading=!1,a.load()}).catch(function(){a.showLoading=!1})):this.$message({message:"排序需要是两位数"})},choseGrade1:function(e,t){var a=this;t.firstCategory=e,this.focusGrade2(!0,t,function(e){t.grade2Val=e[0].name,t.secondCategory=e[0].id,a.choseGrade2(e[0].id,t)})},choseGrade2:function(e,t){t.secondCategory=e,this.focusGrade3(!0,t,function(e){t.grade3Val=e[0].name,t.thirdCategory=e[0].id})},choseGrade3:function(e,t){t.thirdCategory=e},focusGrade2:function(e,t,a){var o=this;e&&this.getCategory(t.firstCategory,function(e){a&&a(e.data),o.$set(t,"grade2",e.data)})},focusGrade3:function(e,t,a){var o=this;e&&this.getCategory(t.secondCategory,function(e){a&&a(e.data),o.$set(t,"grade3",e.data)})},sortchange:function(e,t){e>99&&(this.$message({message:"排序需要是两位数"}),t.sort="")}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"brandandgoods-container"},[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",[a("span",[e._v("页面：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.chosePage},model:{value:e.page.value,callback:function(t){e.$set(e.page,"value",t)},expression:"page.value"}},e._l(e.page.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-col",[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addNewCt}},[e._v("新增类目名")])],1)],1),e._v(" "),a("div",{staticClass:"table-box"},[a("el-table",{staticClass:"lists",attrs:{data:e.lists}},[a("el-table-column",{attrs:{label:"编号",type:"index",fixed:"",index:e.indexMethod}}),e._v(" "),a("el-table-column",{attrs:{label:"一级",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("一级类目：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){e.choseGrade1(a,t.row)}},model:{value:t.row.grade1Val,callback:function(a){e.$set(t.row,"grade1Val",a)},expression:"scope.row.grade1Val"}},e._l(e.grade1,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"二级",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("二级类目：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){e.choseGrade2(a,t.row)},"visible-change":function(a){e.focusGrade2(a,t.row)}},model:{value:t.row.grade2Val,callback:function(a){e.$set(t.row,"grade2Val",a)},expression:"scope.row.grade2Val"}},e._l(t.row.grade2,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"三级",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("三级类目：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){e.choseGrade3(a,t.row)},"visible-change":function(a){e.focusGrade3(a,t.row)}},model:{value:t.row.grade3Val,callback:function(a){e.$set(t.row,"grade3Val",a)},expression:"scope.row.grade3Val"}},e._l(t.row.grade3,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"运营类目名",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("运营类目名:")]),e._v(" "),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.row.customCategory,callback:function(a){e.$set(t.row,"customCategory",a)},expression:"scope.row.customCategory"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"排序",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("排序:")]),e._v(" "),a("el-input",{attrs:{type:"number",placeholder:"请输入内容"},on:{change:function(a){e.sortchange(a,t.row)}},model:{value:t.row.sort,callback:function(a){e.$set(t.row,"sort",a)},expression:"scope.row.sort"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){e.save(t.row)}}},[e._v("保存")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1===t.row.status,expression:"scope.row.status===-1"}],attrs:{type:"success"},on:{click:function(a){e.setUse(t.row,1)}}},[e._v("启动")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1===t.row.status,expression:"scope.row.status===1"}],attrs:{type:"warning"},on:{click:function(a){e.setUse(t.row,-1)}}},[e._v("停用")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(a){e.doDelete(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("Loading",{directives:[{name:"show",rawName:"v-show",value:e.showLoading,expression:"showLoading"}]})],1)},staticRenderFns:[]};var r=a("VU/8")(n,s,!1,function(e){a("EA0T")},null,null);t.default=r.exports}});