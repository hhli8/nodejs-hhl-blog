webpackJsonp([36],{Jk1P:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),l=a.n(o),n=a("oedn"),s=a("TIfe"),i={name:"hotsell",data:function(){return{defaultImg:"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1556618570898&di=311278d4ad073851322da9ec55b0e301&imgtype=0&src=http%3A%2F%2Fku.90sjimg.com%2Felement_origin_min_pic%2F00%2F91%2F87%2F8856f1865e892ed.jpg",uploadUrl:"https://www.xiaoxiangyoupin.com/xxyp-manager/upload/uploadPic",dataList:[],tableData:[],dialogTableVisible:!1,pageNum:1,pageSize:10,showAddDialog:!1,queryGoodsListparam:{},titleName:"",queryparam:{name:"",pageNum:1,pageSize:10,hotType:1,type:1,status:""},checkParam:{name:"",pageNum:1,pageSize:10,hotType:2,type:1},typeArr:[{label:"热销榜",value:1},{label:"更多榜",value:2}],statusArr:[{label:"全部",value:""},{label:"启用",value:1},{label:"禁用",value:0}],brands:[],addGoodsList:[],currentPage:1,totalSize:1,total:"",queryList:[],editGoodsDia:!1,goodsData:[],hotsellName:"",totalQuery:0}},created:function(){this.getList()},computed:{uploadHeader:function(){return{Token:Object(s.c)()}}},methods:{getList:function(){var e=this;n.a.getHotSell(e.queryparam).then(function(t){e.dataList=t.dataList,e.totalSize=t.totalSize,e.total=t.totalSize}).catch()},changeType:function(e){this.checkParam.hotType=e,this.checkParam.type=e},editLine:function(e){this.titleName=e.name,this.dialogTableVisible=!0,this.tableData=e.goodInfo,console.log(this.tableData),this.tableData.forEach(function(t,a){t.sourceFrom=e.sourceFrom,t.sort=a+1})},updateLine:function(e,t){for(var a=this,o=JSON.parse(l()(e)),s=0;s<e.showImg.length;s++)if(!e.showImg[s])return void a.$message({type:"error",message:"请上传两张图片"});delete o.goodInfo,o.type=a.checkParam.type,console.log(o),n.a.updateHotSell(o).then(function(e){200===e.code?(a.$message({type:"success",message:e.message}),a.getList()):a.$message({type:"error",message:e.message})}).catch()},enableLine:function(e){var t=this,a=1===e.status?0:1,o={id:e.id,status:a};n.a.enableHotSell(o).then(function(e){t.getList()}).catch()},editGoods:function(e,t){this.$router.push({name:"addGoods",query:{hotsellName:e.name,hotsellId:e.id}})},deleteLine:function(e){var t=this,a=e;a.status=-1,n.a.enableHotSell(a).then(function(e){t.$message({type:"success",message:e.message}),t.getList()}).catch()},deleteGood:function(e,t){var a=this;console.log(l()(e));var o={hotGoodsId:e.hotGoodsId,id:a.hotsellId};n.a.deleteHotsellGood(o).then(function(e){console.log(l()(e)),a.$message({type:"success",message:e.message}),a.goodsData.splice(t,1)}).catch()},updateGood:function(e,t){var a=this,o=JSON.parse(l()(e));o.id=a.hotsellId,n.a.updateHotSellGood(o).then(function(e){a.getHotsellGoodList(),a.$message({type:"success",message:e.message})}).catch()},getHotsellGoodList:function(){var e=this,t={id:e.hotsellId};n.a.getHotsellGood(t).then(function(t){e.goodsData=t.data}).catch()},add:function(){this.showAddDialog=!0},addGoodBtn:function(){},check:function(){var e=this;n.a.queryHotBrandName(e.checkParam).then(function(t){e.queryList=t.dataList,e.totalQuery=t.totalSize}).catch()},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.checkParam.pageNum=e,this.check()},view:function(e){e.goodInfo.length<=0?this.$message({type:"warning",message:"暂无商品"}):(this.tableData=e.goodInfo,this.titleName=e.name,this.dialogTableVisible=!0)},saveGoods:function(){for(var e=this,t=JSON.parse(l()(e.multipleQueryGoodsTable)),a=0;a<t.length;a++)delete t[a].goodInfo,t[a].type=e.checkParam.type;var o={};o.hotSaleConfigAddReqDTOS=JSON.parse(l()(t)),n.a.addHotSell(o).then(function(t){e.getList(),e.showAddDialog=!1}).catch()},handleSelectionChangeGoods:function(e){this.multipleQueryGoodsTable=e},cancelAdd:function(){this.queryList=[],this.reset(),this.showAddDialog=!1},cancelSaveGoods:function(){this.queryList=[],this.reset(),this.showAddDialog=!1},upLoad:function(e,t,a){this.dataNow=e,this.currentRowIndex=t,this.currentLineIndex=a},handleAvatarSuccess:function(e){this.dataNow.showImg[this.currentLineIndex]=e.data,this.$set(this.dataList,this.currentRowIndex,this.dataNow),this.$message({type:"success",message:"上传成功"})},upLoadAdd:function(e,t,a){this.dataQuery=e,this.currentRowIndex=t,this.currentLineIndex=a},handleAvatarSuccessAdd:function(e){this.dataQuery.showImg[this.currentLineIndex]=e.data,this.$set(this.queryList,this.currentRowIndex,this.dataQuery),this.$message({type:"success",message:"上传成功"})},handleAvatarSuccessLogo:function(){},reset:function(){this.checkParam={name:"",pageNum:1,pageSize:10,hotType:this.queryparam.hotType,type:this.queryparam.type}}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container",attrs:{id:"hotsell"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.queryGoodsListparam}},[a("el-form-item",{attrs:{label:"榜单名:"}},[a("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.queryparam.name,callback:function(t){e.$set(e.queryparam,"name",t)},expression:"queryparam.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态："}},[a("el-select",{attrs:{placeholder:"全部"},model:{value:e.queryparam.status,callback:function(t){e.$set(e.queryparam,"status",t)},expression:"queryparam.status"}},e._l(e.statusArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"榜单切换："}},[a("el-select",{attrs:{placeholder:"全部"},on:{change:e.changeType},model:{value:e.queryparam.type,callback:function(t){e.$set(e.queryparam,"type",t)},expression:"queryparam.type"}},e._l(e.typeArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getList}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")])],1)],1),e._v(" "),a("section",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",align:"center"}},[a("el-table-column",{attrs:{prop:"name",align:"center",label:"榜单名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"榜单副标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.title,callback:function(a){e.$set(t.row,"title",a)},expression:"scope.row.title"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sourceFrom",align:"center",width:"90",label:"来源网站"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",align:"center",width:"250",label:"首页展示图片（2张）"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.showImg,function(o,l){return a("el-upload",{key:l,staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccess}},[a("img",{staticClass:"avatar",attrs:{width:"100px",src:o||e.defaultImg},on:{click:function(a){e.upLoad(t.row,t.$index,l)}}})])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sort",align:"center",width:"80",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.sort,callback:function(a){e.$set(t.row,"sort",a)},expression:"scope.row.sort"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.editLine(t.row)}}},[e._v("预览")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){e.updateLine(t.row,1)}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.editGoods(t.row)}}},[e._v("配置商品")]),e._v(" "),0===t.row.status?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){e.enableLine(t.row,1)}}},[e._v("点击启用")]):e._e(),e._v(" "),1===t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.enableLine(t.row,1)}}},[e._v("点击禁用")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.deleteLine(t.row,1)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.currentPage,"page-sizes":[10],"page-size":e.pageSize,total:e.totalSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"添加榜单",width:"92%",visible:e.showAddDialog,"close-on-click-modal":!1,"before-close":e.cancelAdd},on:{"update:visible":function(t){e.showAddDialog=t}}},[a("section",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入榜单名称"},model:{value:e.checkParam.name,callback:function(t){e.$set(e.checkParam,"name",t)},expression:"checkParam.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.check}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),e._v(" "),a("section",[a("el-table",{ref:"multipleQueryGoodsTable",staticStyle:{width:"100%"},attrs:{data:e.queryList,border:"",align:"center"},on:{"selection-change":e.handleSelectionChangeGoods}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"topId",align:"center",label:"榜单编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"榜单名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",align:"center",width:"250",label:"首页展示图片（2张）"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.showImg,function(o,l){return a("el-upload",{key:l,staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccessAdd}},[a("img",{staticClass:"avatar",attrs:{width:"100px",src:o||e.defaultImg},on:{click:function(a){e.upLoadAdd(t.row,t.$index,l)}}})])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"number",placeholder:"越小越靠前"},model:{value:t.row.sort,callback:function(a){e.$set(t.row,"sort",a)},expression:"scope.row.sort"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"榜单副标题（首页slogan和热销榜）"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"榜单副标题"},model:{value:t.row.title,callback:function(a){e.$set(t.row,"title",a)},expression:"scope.row.title"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sourceFrom",align:"center",label:"来源"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createDate",align:"center",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.view(t.row)}}},[e._v("预览")])]}}])})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.totalQuery},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("hr"),e._v(" "),a("el-row",[a("el-button",{on:{click:e.cancelSaveGoods}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveGoods}},[e._v("确定")])],1)],1),e._v(" "),a("el-dialog",{staticClass:"dialogLook",attrs:{visible:e.dialogTableVisible,title:"预览-"+e.titleName,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-table",{attrs:{data:e.tableData,border:"",height:"400"}},[a("el-table-column",{attrs:{prop:"sourceFrom",align:"center",label:"来源",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sort",align:"center",label:"商品排序",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"hotGoodsName",align:"center",label:"商品标题",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{prop:"hotGoodsUrl",align:"center",label:"商品图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticClass:"dialogImg",attrs:{src:e.row.hotGoodsUrl,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"hotGoodsPrice",align:"center",label:"售价"}})],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(i,r,!1,function(e){a("mjG9"),a("me2E")},"data-v-62a4b124",null);t.default=c.exports},me2E:function(e,t){},mjG9:function(e,t){}});