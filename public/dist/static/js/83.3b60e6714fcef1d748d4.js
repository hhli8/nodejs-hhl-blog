webpackJsonp([83],{"4YJw":function(e,t){},"7ksz":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),l=a.n(o),n=a("oedn"),r=a("TIfe"),s={name:"addGoods",data:function(){return{curRowIndex:0,uploadUrl:"https://www.xiaoxiangyoupin.com/xxyp-manager/upload/uploadPic",hotsellName:"",goodsData:[],newTable:[],multipleTable:[],showSelectGoodsDia:!1,checkParam:{categoryOne:"",categoryTwo:"",categoryThree:"",status:"",gTile:"",pageSize:10,pageNum:1},brands1:[],brands2:[],brands3:[],statusArr:[{label:"全部",value:""},{label:"启用",value:1},{label:"禁用",value:0}],currentPage:1,pageSize:0,newtotalSize:0}},computed:{uploadHeader:function(){return{Token:Object(r.c)()}}},created:function(){this.hotsellName=this.$route.query.hotsellName,this.hotsellId=this.$route.query.hotsellId,this.getGoodList(),this.getBrands(0,1)},methods:{getBrands:function(e,t){var a=this,o={parentId:e};n.a.getCategoryList(o).then(function(e){a.brands1=e.data,a.getBrands2(a.brands1[0].name,2)}).catch()},getBrands2:function(e,t){var a=this,o={};a.brands1.forEach(function(t,a){t.name!==e||(o.parentId=t.id)}),n.a.getCategoryList(o).then(function(e){a.brands2=e.data,a.brands3=[],a.checkParam.categoryTwo="",a.checkParam.categoryThree=""}).catch()},getBrands3:function(e,t){var a=this,o={};a.brands2.forEach(function(t,a){t.name!==e||(o.parentId=t.id)}),n.a.getCategoryList(o).then(function(e){a.brands3=e.data,a.checkParam.categoryThree=""}).catch()},getGoodList:function(){var e=this,t={id:e.hotsellId};n.a.getHotsellGood(t).then(function(t){e.goodsData=t.data}).catch()},getNewGoodsList:function(){var e=this;n.a.getNewGoodList(e.checkParam).then(function(t){e.newTable=t.dataList,e.newtotalSize=t.totalSize}).catch()},handleSelectionChange:function(e){this.multipleTable=e},handleCurrentChange:function(e){this.checkParam.pageNum=e,this.getNewGoodsList()},changeDefaultpic:function(e,t){this.goodsData[t].hotGoodsUrl=e.defaultHotGoodsUrl},handleAvatarSuccessLogo:function(e){this.$message({type:"success",message:e.message}),this.goodsData[this.curRowIndex].hotGoodsUrl=e.data},updateGood:function(e,t){var a=this,o=JSON.parse(l()(e));o.id=a.hotsellId;var r={};r.hotSaleConfigGoodsSearchDTOS=o,n.a.updateHotSellGood(r).then(function(e){a.getGoodList(),a.$message({type:"success",message:e.message})}).catch()},deleteGood:function(e,t){var a=this,o={hotGoodsId:e.hotGoodsId,id:a.hotsellId};n.a.deleteHotsellGood(o).then(function(e){a.$message({type:"success",message:e.message}),a.goodsData.splice(t,1),a.getGoodList()}).catch()},saveGoodsTohotsell:function(){for(var e=this,t=JSON.parse(l()(e.multipleTable)),a=0;a<t.length;a++)t[a].id=e.hotsellId;var o={};o.hotSaleConfigGoodsSearchDTOS=t,n.a.updateHotSellGood(o).then(function(t){e.$message({type:"success",message:t.message}),e.getGoodList()}).catch()},priceFormatter:function(e,t){return(e.hotGoodsPrice/100).toFixed(2)}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container",attrs:{id:"hotsellGoods"}},[a("div",[a("el-input",{staticStyle:{width:"40%","margin-bottom":"20px",disabled:"true"},attrs:{readonly:""},model:{value:e.hotsellName,callback:function(t){e.hotsellName=t},expression:"hotsellName"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showSelectGoodsDia=!0}}},[e._v("新增商品")])],1),e._v(" "),a("div",{staticClass:"editGood"},[a("el-table",{attrs:{data:e.goodsData,border:""}},[a("el-table-column",{attrs:{align:"center",property:"hotGoodsName",label:"商品标题",width:"450"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",property:"sort",label:"商品排序",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.sort,callback:function(a){e.$set(t.row,"sort",a)},expression:"scope.row.sort"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",property:"name",label:"商品图片",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{attrs:{width:"120px",src:t.row.hotGoodsUrl,alt:""}}),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{headers:e.uploadHeader,action:e.uploadUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccessLogo}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.curRowIndex=t.$index}}},[e._v("重新上传")])],1),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.changeDefaultpic(t.row,t.$index)}}},[e._v("改回默认")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",property:"hotGoodsPrice",formatter:e.priceFormatter,label:"售价(元)"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",property:"address",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.updateGood(t.row)}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.deleteGood(t.row,t.$index)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("el-dialog",{staticClass:"goodDia",attrs:{title:"新增榜单商品",visible:e.showSelectGoodsDia,width:"93%"},on:{"update:visible":function(t){e.showSelectGoodsDia=t}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"一级类目"}},[a("el-select",{attrs:{placeholder:"全部"},on:{change:function(t){e.getBrands2(t,e.checkParam.categoryOne)}},model:{value:e.checkParam.categoryOne,callback:function(t){e.$set(e.checkParam,"categoryOne",t)},expression:"checkParam.categoryOne"}},e._l(e.brands1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"二级类目"}},[a("el-select",{attrs:{placeholder:"全部"},on:{change:function(t){e.getBrands3(t,e.checkParam.categoryTwo)}},model:{value:e.checkParam.categoryTwo,callback:function(t){e.$set(e.checkParam,"categoryTwo",t)},expression:"checkParam.categoryTwo"}},e._l(e.brands2,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"三级类目"}},[a("el-select",{attrs:{placeholder:"全部"},model:{value:e.checkParam.categoryThree,callback:function(t){e.$set(e.checkParam,"categoryThree",t)},expression:"checkParam.categoryThree"}},e._l(e.brands3,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"状态："}},[a("el-select",{attrs:{placeholder:"全部"},model:{value:e.checkParam.status,callback:function(t){e.$set(e.checkParam,"status",t)},expression:"checkParam.status"}},e._l(e.statusArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.checkParam.gTile,callback:function(t){e.$set(e.checkParam,"gTile",t)},expression:"checkParam.gTile"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getNewGoodsList}},[e._v("查询")])],1)],1),e._v(" "),a("div",{staticClass:"editGood"},[a("el-table",{ref:"multipleTable",attrs:{height:"550",data:e.newTable,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",property:"hotGoodsName",label:"商品标题",width:"450"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",property:"name",label:"商品主图",width:"300"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{width:"100px",src:e.row.defaultHotGoodsUrl,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",property:"hotGoodsPrice",formatter:e.priceFormatter,label:"售价(元)"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",property:"hotGoodsCountry",label:"来源国家"}})],1),e._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{"current-page":e.currentPage,"page-sizes":[10],"page-size":e.pageSize,total:e.newtotalSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:e.saveGoodsTohotsell}},[e._v("添加商品")])],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,c,!1,function(e){a("4YJw")},null,null);t.default=i.exports}});