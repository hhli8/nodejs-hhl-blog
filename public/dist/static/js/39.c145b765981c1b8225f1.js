webpackJsonp([39],{JiaK:function(e,t){},M1JW:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),o=a.n(s),n=a("oedn"),i=a("TIfe"),r={name:"special",data:function(){return{flag:!1,Clickflag:!1,showAddDialog:!1,uploadUrl:"https://www.xiaoxiangyoupin.com/xxyp-manager/upload/uploadPic",queryparam:{type:2,showType:1,pageNum:1,pageSize:20},checkParam:{title:"",status:1,pageNum:1,pageSize:20},defaultStatus:"已选入",statusArr:[{label:"全部",value:""},{label:"已选入",value:1}],type:2,dataList:[{}],goodsDataList:[],specialArr:[],currentPage:1,pageNum:1,pageSize:20,totalSize:0,dialogFormVisible:!1,formLabelWidth:"120px",searchAllow:!0,form:{imgType:1,imgTagStatus:1,imgTag:"",imgTagText:"",standTagStatus:"",standTag:"",standTagText:"",goodImg:[]},bannerId:"",curRowIndex:-1,oneRecording:!1}},created:function(){this.getBannerTypeList(),this.getList()},computed:{uploadHeader:function(){return{Token:Object(i.c)()}}},methods:{getBannerTypeList:function(){var e=this;n.a.getTypeList({type:1}).then(function(t){e.specialArr=t.data}).catch()},beforeUploadIndex:function(){if(this.form.goodImg&&2===this.form.goodImg.length)return this.$message.warning("上传图片不能超过两张"),!1},onDelete:function(e){var t=this;this.$confirm("你确定要删除当前图片吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.form.goodImg.splice(e,1),t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},changeType:function(e){var t=this,a=this;a.type=e,a.checkParam.type=e,this.oneRecording=!1;var s=this.specialArr.filter(function(t){return t.type===e})[0];this.typeName=s.typeName,this.bannerId=s.bannerId,a.getList().then(function(){a.$message({type:"success",message:"专场已切换为"+t.typeName})})},onSuccessIndex:function(e,t,a){this.form.goodImg.push(e.data),this.$message({type:"success",message:"图片上传成功"})},changeVal:function(e){e?(this.searchAllow=!0,this.checkParam.status=1):(this.searchAllow=!1,this.checkParam.status="")},getList:function(){var e=this;return n.a.getSpecialList(e.queryparam).then(function(t){return e.dataList=t.dataList,e.bannerId=e.dataList[0].id,e.checkParam.bannerId=e.bannerId,2!==e.bannerId&&3!==e.bannerId||e.getGoodsList(),t}).catch()},getGoodsList:function(){var e=this;e.checkParam.title||e.searchAllow?n.a.getGoodsList(e.checkParam).then(function(t){e.goodsDataList=t.dataList,e.totalSize=t.totalSize,e.Clickflag=!1}).catch():e.$message({type:"error",message:"请输入搜索词"})},formatPrice:function(e,t){return(e.salePrice/100).toFixed(2)},selectLine:function(e){var t=this;if(t.bannerId){var a=1===e.status?-1:1,s={bannerId:t.bannerId,targetCode:e.targetCode,status:a};t.Clickflag=!0,n.a.selectToggle(s).then(function(e){t.$message({type:"success",message:e.message}),t.getGoodsList()}).catch()}else t.$message({type:"error",message:"请先查询专场列表"})},formatPrice2:function(e,t){return(e.officialPrice/100).toFixed(2)},updateLine:function(e){var t=this;e.imgType=t.form.imgType,e.imgTagStatus=t.form.imgTagStatus,e.imgTag=t.form.imgTag,e.imgTagText=t.form.imgTagText,e.standTagStatus=t.form.standTagStatus,e.standTag=t.form.standTag,e.standTagText=t.form.standTagText,e.bannerType=1,e.goodImg=JSON.parse(o()(t.form.goodImg)).join().replace(",","|"),n.a.saveSpecial(e).then(function(e){200===e.code?(t.$message({type:"success",message:e.message}),t.flag=!1,t.getList()):t.$message({type:"error",message:e.message})}).catch()},editLine:function(e){this.oneRecording||(this.form.imgType=e.imgType,this.form.imgTagStatus=e.imgTagStatus,this.form.imgTag=e.imgTag,this.form.imgTagText=e.imgTagText,this.form.standTagStatus=e.standTagStatus,this.form.standTag=e.standTag,this.form.standTagText=e.standTagText,this.form.goodImg=""===e.goodImg?[]:e.goodImg,this.oneRecording=!0),console.log(this.form),this.showAddDialog=!0},uploadSuccess:function(){},handleSizeChange:function(e){this.checkParam.pageSize=e,this.pageSize=e,this.getGoodsList()},handleCurrentChange:function(e){this.checkParam.pageNum=e,this.pageNum=e,this.getGoodsList()},handleAvatarSuccess:function(e){this.dataList[this.curRowIndex].imgUrl=e.data},uploadimgTagSuccess:function(e){this.form.imgTag=e.data},uploadStandTagSuccess:function(e){this.form.standTag=e.data},release:function(){var e=this,t={};t.goodsSortReqDTOs=JSON.parse(o()(e.goodsDataList)),n.a.sortHaitaoGoods(t).then(function(t){e.$message({type:"success",message:t.message}),e.getGoodsList()}).catch()}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"专场名称："}},[a("el-select",{attrs:{placeholder:"全部"},on:{change:e.changeType},model:{value:e.queryparam.type,callback:function(t){e.$set(e.queryparam,"type",t)},expression:"queryparam.type"}},e._l(e.specialArr,function(e){return a("el-option",{key:e.type,attrs:{label:e.typeName,value:e.type}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getList}},[e._v("查询")])],1)],1),e._v(" "),a("section",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",align:"center"}},[a("el-table-column",{attrs:{prop:"name",align:"center",label:2===e.bannerId||3===e.bannerId?"*专场小标题":"*专场名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"imgUrl",align:"center",label:"*标题背景图"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{attrs:{width:"120px",src:t.row.imgUrl,alt:""}}),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{headers:e.uploadHeader,action:e.uploadUrl,"on-success":e.handleAvatarSuccess}},[a("el-button",{attrs:{size:"medium",type:"primary"},nativeOn:{click:function(a){e.curRowIndex=t.$index}}},[e._v("重新上传")])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sourceFrom",align:"center",label:"详细功能配置"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(a){e.editLine(t.row)}}},[e._v("编辑")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"mainTitle",align:"center",label:"小标题（国家馆，全球好货，其他为空）",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.mainTitle,callback:function(a){e.$set(t.row,"mainTitle",a)},expression:"scope.row.mainTitle"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"colour",align:"center",label:"背景色号",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"背景色号"},model:{value:t.row.colour,callback:function(a){e.$set(t.row,"colour",a)},expression:"scope.row.colour"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"medium",type:"success"},on:{click:function(a){e.updateLine(t.row,1)}}},[e._v("保存")])]}}])})],1)],1),e._v(" "),2===e.bannerId||3===e.bannerId?a("section",{staticStyle:{"margin-top":"24px"}},[a("div",[a("h2",[e._v("产品选品配置-"+e._s(2===e.bannerId?"官网首发":"各国爆款"))])]),e._v(" "),a("hr"),e._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"状态："}},[a("el-select",{attrs:{placeholder:""},on:{change:e.changeVal},model:{value:e.defaultStatus,callback:function(t){e.defaultStatus=t},expression:"defaultStatus"}},e._l(e.statusArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.checkParam.title,callback:function(t){e.$set(e.checkParam,"title",t)},expression:"checkParam.title"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getGoodsList}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.release}},[e._v("发布")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.goodsDataList,border:"",align:"center"}},[a("el-table-column",{attrs:{prop:"goodImg",align:"center",label:"商品主图"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.row.goodImg,fit:"contain"},on:{click:function(a){e.$store.dispatch("openImgPreview",{url:t.row.goodImg})}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"discount",align:"center",label:"折扣"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sort",align:"center",width:"100",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.sort,callback:function(a){e.$set(t.row,"sort",a)},expression:"scope.row.sort"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"salePrice",formatter:e.formatPrice,align:"center",label:"现售价"}}),e._v(" "),a("el-table-column",{attrs:{prop:"officialPrice",formatter:e.formatPrice2,align:"center",label:"原价"}}),e._v(" "),a("el-table-column",{attrs:{prop:"gtitle",align:"center",label:"产品大标题"}}),e._v(" "),a("el-table-column",{attrs:{prop:"secondCategoryName",align:"center",label:"二级类目"}}),e._v(" "),a("el-table-column",{attrs:{prop:"thirdCategoryName",align:"center",label:"三级类目"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?a("el-button",{attrs:{size:"mini",disabled:e.Clickflag,type:"success"},on:{click:function(a){e.selectLine(t.row,1)}}},[e._v("已选入")]):e._e(),e._v(" "),-1===t.row.status?a("el-button",{attrs:{size:"mini",disabled:e.Clickflag,type:"danger"},on:{click:function(a){e.selectLine(t.row,1)}}},[e._v("未选入")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pagination other-pagination",attrs:{"current-page":e.currentPage,"page-sizes":[20,30,40,50],"page-size":e.pageSize,total:e.totalSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"专场图片标签详细功能配置",width:"60%",visible:e.showAddDialog},on:{"update:visible":function(t){e.showAddDialog=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"图片样式"}},[a("el-radio-group",{model:{value:e.form.imgType,callback:function(t){e.$set(e.form,"imgType",t)},expression:"form.imgType"}},[a("el-radio",{attrs:{label:1}},[e._v("头部图片")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("背景图片")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"专场图片标签"}},[a("el-radio-group",{model:{value:e.form.imgTagStatus,callback:function(t){e.$set(e.form,"imgTagStatus",t)},expression:"form.imgTagStatus"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:-1}},[e._v("禁用")])],1),e._v(" "),a("el-input",{model:{value:e.form.imgTagText,callback:function(t){e.$set(e.form,"imgTagText",t)},expression:"form.imgTagText"}}),e._v(" "),a("img",{attrs:{width:"120px",src:e.form.imgTag,alt:""}}),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{headers:e.uploadHeader,action:e.uploadUrl,"show-file-list":!1,"on-success":e.uploadimgTagSuccess}},[a("el-button",{attrs:{size:"medium",type:"primary"}},[e._v("重新上传")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"专场立够标签"}},[a("el-radio-group",{model:{value:e.form.standTagStatus,callback:function(t){e.$set(e.form,"standTagStatus",t)},expression:"form.standTagStatus"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:-1}},[e._v("禁用")])],1),e._v(" "),a("el-input",{model:{value:e.form.standTagText,callback:function(t){e.$set(e.form,"standTagText",t)},expression:"form.standTagText"}}),e._v(" "),a("img",{attrs:{width:"120px",src:e.form.standTag,alt:""}}),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{headers:e.uploadHeader,action:e.uploadUrl,"show-file-list":!1,"on-success":e.uploadStandTagSuccess}},[a("el-button",{attrs:{size:"medium",type:"primary"}},[e._v("重新上传")])],1)],1),e._v(" "),15===e.bannerId?a("el-form-item",{attrs:{label:"首页展示图"}},[a("div",{staticClass:"index-show"},[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.uploadUrl,headers:e.uploadHeader,"show-file-list":!1,"on-success":e.onSuccessIndex,"before-upload":e.beforeUploadIndex,multiple:""}},[a("div",{staticClass:"upload-area"},[a("el-button",{staticClass:"reserve",attrs:{size:"medium",type:"primary"}},[e._v(e._s(e.form.goodImg&&2===e.form.goodImg.length?"重新上传":"上传图片"))])],1)]),e._v(" "),a("div",{staticClass:"wrapper-index"},e._l(e.form.goodImg,function(t,s){return a("div",{key:s,staticClass:"list"},[a("div",{staticClass:"indexShowImg",style:{backgroundImage:"url("+t+")"}}),e._v(" "),a("i",{staticClass:"el-icon-delete",on:{click:function(t){e.onDelete(s)}}})])}))],1)]):e._e()],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(r,l,!1,function(e){a("JiaK"),a("zU0X")},"data-v-2191ea1c",null);t.default=c.exports},zU0X:function(e,t){}});